/*! For license information please see formSubmit.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=s>>2,u=(3&s)<<4|o>>4;let h=(15&o)<<2|c>>6,f=63&c;a||(f=64,r||(h=64)),i.push(n[l],n[u],n[h],n[f])}return i.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==o||null==a||null==c)throw new i;const l=r<<2|o>>4;if(s.push(l),64!==a){const t=o<<4&240|a>>2;if(s.push(t),64!==c){const t=a<<6&192|c;s.push(t)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s=function(t){return function(t){const i=e(t);return n.encodeByteArray(i,!0)}(t).replace(/\./g,"")},r=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&function(t){try{return n.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},o=()=>{var t;return null===(t=r())||void 0===t?void 0:t.config};class a{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function c(){try{return"object"==typeof indexedDB}catch(t){return!1}}function l(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class u extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,u.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,h.prototype.create)}}class h{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(f,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new u(i,o,n)}}const f=/\{\$([^}]+)}/g;function d(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(p(n)&&p(r)){if(!d(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function p(t){return null!==t&&"object"==typeof t}const g=1e3,m=2,y=144e5,v=.5;function w(t,e=g,n=m){const i=e*Math.pow(n,t),s=Math.round(v*i*(Math.random()-.5)*2);return Math.min(y,i+s)}function b(t){return t&&t._delegate?t._delegate:t}class E{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const I="[DEFAULT]";class T{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new a;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:I})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=I){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=I){return this.instances.has(t)}getOptions(t=I){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===I?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=I){return this.component?this.component.multipleInstances?t:I:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class S{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new T(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const A=[];var C,D;(D=C||(C={}))[D.DEBUG=0]="DEBUG",D[D.VERBOSE=1]="VERBOSE",D[D.INFO=2]="INFO",D[D.WARN=3]="WARN",D[D.ERROR=4]="ERROR",D[D.SILENT=5]="SILENT";const _={debug:C.DEBUG,verbose:C.VERBOSE,info:C.INFO,warn:C.WARN,error:C.ERROR,silent:C.SILENT},N=C.INFO,k={[C.DEBUG]:"log",[C.VERBOSE]:"log",[C.INFO]:"info",[C.WARN]:"warn",[C.ERROR]:"error"},O=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=k[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class R{constructor(t){this.name=t,this._logLevel=N,this._logHandler=O,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in C))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?_[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,C.DEBUG,...t),this._logHandler(this,C.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,C.VERBOSE,...t),this._logHandler(this,C.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,C.INFO,...t),this._logHandler(this,C.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,C.WARN,...t),this._logHandler(this,C.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,C.ERROR,...t),this._logHandler(this,C.ERROR,...t)}}const L=(t,e)=>e.some((e=>t instanceof e));let x,M;const P=new WeakMap,F=new WeakMap,V=new WeakMap,U=new WeakMap,B=new WeakMap;let j={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return F.get(t);if("objectStoreNames"===e)return t.objectStoreNames||V.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return q(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function $(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(M||(M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(z(this),t),q(P.get(this))}:function(...t){return q(e.apply(z(this),t))}:function(t,...n){const i=e.call(z(this),t,...n);return V.set(i,t.sort?t.sort():[t]),q(i)}:(t instanceof IDBTransaction&&function(t){if(F.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));F.set(t,e)}(t),L(t,x||(x=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,j):t);var e}function q(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(q(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&P.set(e,t)})).catch((()=>{})),B.set(e,t),e}(t);if(U.has(t))return U.get(t);const e=$(t);return e!==t&&(U.set(t,e),B.set(e,t)),e}const z=t=>B.get(t),H=["get","getKey","getAll","getAllKeys","count"],K=["put","add","delete","clear"],G=new Map;function Q(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(G.get(e))return G.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=K.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!H.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return G.set(e,r),r}var W;W=j,j={...W,get:(t,e,n)=>Q(t,e)||W.get(t,e,n),has:(t,e)=>!!Q(t,e)||W.has(t,e)};class X{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const Y="@firebase/app",J="0.9.11",Z=new R("@firebase/app"),tt="[DEFAULT]",et={[Y]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},nt=new Map,it=new Map;function st(t,e){try{t.container.addComponent(e)}catch(n){Z.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function rt(t){const e=t.name;if(it.has(e))return Z.debug(`There were multiple attempts to register component ${e}.`),!1;it.set(e,t);for(const e of nt.values())st(e,t);return!0}function ot(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const at=new h("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ct{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new E("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw at.create("app-deleted",{appName:this._name})}}function lt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:tt,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw at.create("bad-app-name",{appName:String(s)});if(n||(n=o()),!n)throw at.create("no-options");const r=nt.get(s);if(r){if(d(n,r.options)&&d(i,r.config))return r;throw at.create("duplicate-app",{appName:s})}const a=new S(s);for(const t of it.values())a.addComponent(t);const c=new ct(n,i,a);return nt.set(s,c),c}function ut(t=tt){const e=nt.get(t);if(!e&&t===tt&&o())return lt();if(!e)throw at.create("no-app",{appName:t});return e}function ht(t,e,n){var i;let s=null!==(i=et[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const t=[`Unable to register library "${s}" with version "${e}":`];return r&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void Z.warn(t.join(" "))}rt(new E(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}const ft="firebase-heartbeat-database",dt=1,pt="firebase-heartbeat-store";let gt=null;function mt(){return gt||(gt=function(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=q(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(q(o.result),t.oldVersion,t.newVersion,q(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(t=>s(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(ft,dt,{upgrade:(t,e)=>{0===e&&t.createObjectStore(pt)}}).catch((t=>{throw at.create("idb-open",{originalErrorMessage:t.message})}))),gt}async function yt(t,e){try{const n=(await mt()).transaction(pt,"readwrite"),i=n.objectStore(pt);await i.put(e,vt(t)),await n.done}catch(t){if(t instanceof u)Z.warn(t.message);else{const e=at.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});Z.warn(e.message)}}}function vt(t){return`${t.name}!${t.options.appId}`}class wt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Et(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=bt();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=bt(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),It(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),It(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=s(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function bt(){return(new Date).toISOString().substring(0,10)}class Et{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!c()&&l().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await mt();return await e.transaction(pt).objectStore(pt).get(vt(t))}catch(t){if(t instanceof u)Z.warn(t.message);else{const e=at.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});Z.warn(e.message)}}}(this.app);return t||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return yt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return yt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function It(t){return s(JSON.stringify({version:2,heartbeats:t})).length}rt(new E("platform-logger",(t=>new X(t)),"PRIVATE")),rt(new E("heartbeat",(t=>new wt(t)),"PRIVATE")),ht(Y,J,""),ht(Y,J,"esm2017"),ht("fire-js",""),ht("firebase","9.22.1","app");var Tt,St="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},At={},Ct=Ct||{},Dt=St||self;function _t(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Nt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var kt="closure_uid_"+(1e9*Math.random()>>>0),Ot=0;function Rt(t,e,n){return t.call.apply(t.bind,arguments)}function Lt(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function xt(t,e,n){return(xt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Rt:Lt).apply(null,arguments)}function Mt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Pt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}function Ft(){this.s=this.s,this.o=this.o}Ft.prototype.s=!1,Ft.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,kt)&&t[kt]||(t[kt]=++Ot))},Ft.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Vt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Ut(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Bt(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(_t(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let s=0;s<i;s++)t[e+s]=n[s]}else t.push(n)}}function jt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}jt.prototype.h=function(){this.defaultPrevented=!0};var $t=function(){if(!Dt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Dt.addEventListener("test",(()=>{}),e),Dt.removeEventListener("test",(()=>{}),e)}catch(t){}return t}();function qt(t){return/^[\s\xa0]*$/.test(t)}function zt(){var t=Dt.navigator;return t&&(t=t.userAgent)?t:""}function Ht(t){return-1!=zt().indexOf(t)}function Kt(t){return Kt[" "](t),t}Kt[" "]=function(){};var Gt,Qt,Wt,Xt=Ht("Opera"),Yt=Ht("Trident")||Ht("MSIE"),Jt=Ht("Edge"),Zt=Jt||Yt,te=Ht("Gecko")&&!(-1!=zt().toLowerCase().indexOf("webkit")&&!Ht("Edge"))&&!(Ht("Trident")||Ht("MSIE"))&&!Ht("Edge"),ee=-1!=zt().toLowerCase().indexOf("webkit")&&!Ht("Edge");function ne(){var t=Dt.document;return t?t.documentMode:void 0}t:{var ie="",se=(Qt=zt(),te?/rv:([^\);]+)(\)|;)/.exec(Qt):Jt?/Edge\/([\d\.]+)/.exec(Qt):Yt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Qt):ee?/WebKit\/(\S+)/.exec(Qt):Xt?/(?:Version)[ \/]?(\S+)/.exec(Qt):void 0);if(se&&(ie=se?se[1]:""),Yt){var re=ne();if(null!=re&&re>parseFloat(ie)){Gt=String(re);break t}}Gt=ie}Dt.document&&Yt?Wt=ne()||parseInt(Gt,10)||void 0:Wt=void 0;var oe=Wt;function ae(t,e){if(jt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(te){t:{try{Kt(e.nodeName);var s=!0;break t}catch(t){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ce[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ae.$.h.call(this)}}Pt(ae,jt);var ce={2:"touch",3:"pen",4:"mouse"};ae.prototype.h=function(){ae.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var le="closure_listenable_"+(1e6*Math.random()|0),ue=0;function he(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=s,this.key=++ue,this.fa=this.ia=!1}function fe(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function de(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function pe(t){const e={};for(const n in t)e[n]=t[n];return e}const ge="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<ge.length;e++)n=ge[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ye(t){this.src=t,this.g={},this.h=0}function ve(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],r=Vt(s,e);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(fe(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function we(t,e,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(!r.fa&&r.listener==e&&r.capture==!!n&&r.la==i)return s}return-1}ye.prototype.add=function(t,e,n,i,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=we(t,e,i,s);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new he(e,this.src,r,!!i,s)).ia=n,t.push(e)),e};var be="closure_lm_"+(1e6*Math.random()|0),Ee={};function Ie(t,e,n,i,s){if(i&&i.once)return Se(t,e,n,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)Ie(t,e[r],n,i,s);return null}return n=Oe(n),t&&t[le]?t.O(e,n,Nt(i)?!!i.capture:!!i,s):Te(t,e,n,!1,i,s)}function Te(t,e,n,i,s,r){if(!e)throw Error("Invalid event type");var o=Nt(s)?!!s.capture:!!s,a=Ne(t);if(a||(t[be]=a=new ye(t)),(n=a.add(e,n,i,o,r)).proxy)return n;if(i=function(){const t=_e;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)$t||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(De(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Se(t,e,n,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)Se(t,e[r],n,i,s);return null}return n=Oe(n),t&&t[le]?t.P(e,n,Nt(i)?!!i.capture:!!i,s):Te(t,e,n,!0,i,s)}function Ae(t,e,n,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)Ae(t,e[r],n,i,s);else i=Nt(i)?!!i.capture:!!i,n=Oe(n),t&&t[le]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=we(r=t.g[e],n,i,s))&&(fe(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--))):t&&(t=Ne(t))&&(e=t.g[e.toString()],t=-1,e&&(t=we(e,n,i,s)),(n=-1<t?e[t]:null)&&Ce(n))}function Ce(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[le])ve(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(De(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ne(e))?(ve(n,t),0==n.h&&(n.src=null,e[be]=null)):fe(t)}}}function De(t){return t in Ee?Ee[t]:Ee[t]="on"+t}function _e(t,e){if(t.fa)t=!0;else{e=new ae(e,this);var n=t.listener,i=t.la||t.src;t.ia&&Ce(t),t=n.call(i,e)}return t}function Ne(t){return(t=t[be])instanceof ye?t:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function Oe(t){return"function"==typeof t?t:(t[ke]||(t[ke]=function(e){return t.handleEvent(e)}),t[ke])}function Re(){Ft.call(this),this.i=new ye(this),this.S=this,this.J=null}function Le(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new jt(e,t);else if(e instanceof jt)e.target=e.target||t;else{var s=e;me(e=new jt(i,t),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];s=xe(o,i,!0,e)&&s}if(s=xe(o=e.g=t,i,!0,e)&&s,s=xe(o,i,!1,e)&&s,n)for(r=0;r<n.length;r++)s=xe(o=e.g=n[r],i,!1,e)&&s}function xe(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&ve(t.i,o),s=!1!==a.call(c,i)&&s}}return s&&!i.defaultPrevented}Pt(Re,Ft),Re.prototype[le]=!0,Re.prototype.removeEventListener=function(t,e,n,i){Ae(this,t,e,n,i)},Re.prototype.N=function(){if(Re.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)fe(n[i]);delete e.g[t],e.h--}}this.J=null},Re.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Re.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Me=Dt.JSON.stringify;function Pe(){var t=qe;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Fe=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Ve),(t=>t.reset()));class Ve{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Ue(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Be(t){Dt.setTimeout((()=>{throw t}),0)}let je,$e=!1,qe=new class{constructor(){this.h=this.g=null}add(t,e){const n=Fe.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},ze=()=>{const t=Dt.Promise.resolve(void 0);je=()=>{t.then(He)}};var He=()=>{for(var t;t=Pe();){try{t.h.call(t.g)}catch(t){Be(t)}var e=Fe;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}$e=!1};function Ke(t,e){Re.call(this),this.h=t||1,this.g=e||Dt,this.j=xt(this.qb,this),this.l=Date.now()}function Ge(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function Qe(t,e,n){if("function"==typeof t)n&&(t=xt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=xt(t.handleEvent,t)}return 2147483647<Number(e)?-1:Dt.setTimeout(t,e||0)}function We(t){t.g=Qe((()=>{t.g=null,t.i&&(t.i=!1,We(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Pt(Ke,Re),(Tt=Ke.prototype).ga=!1,Tt.T=null,Tt.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Le(this,"tick"),this.ga&&(Ge(this),this.start()))}},Tt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Tt.N=function(){Ke.$.N.call(this),Ge(this),delete this.g};class Xe extends Ft{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:We(this)}N(){super.N(),this.g&&(Dt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ye(t){Ft.call(this),this.h=t,this.g={}}Pt(Ye,Ft);var Je=[];function Ze(t,e,n,i){Array.isArray(n)||(n&&(Je[0]=n.toString()),n=Je);for(var s=0;s<n.length;s++){var r=Ie(e,n[s],i||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function tn(t){de(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ce(t)}),t),t.g={}}function en(){this.g=!0}function nn(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return Me(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Ye.prototype.N=function(){Ye.$.N.call(this),tn(this)},Ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},en.prototype.Ea=function(){this.g=!1},en.prototype.info=function(){};var sn={},rn=null;function on(){return rn=rn||new Re}function an(t){jt.call(this,sn.Ta,t)}function cn(t){const e=on();Le(e,new an(e))}function ln(t,e){jt.call(this,sn.STAT_EVENT,t),this.stat=e}function un(t){const e=on();Le(e,new ln(e,t))}function hn(t,e){jt.call(this,sn.Ua,t),this.size=e}function fn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Dt.setTimeout((function(){t()}),e)}sn.Ta="serverreachability",Pt(an,jt),sn.STAT_EVENT="statevent",Pt(ln,jt),sn.Ua="timingevent",Pt(hn,jt);var dn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},pn={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function gn(){}function mn(t){return t.h||(t.h=t.i())}function yn(){}gn.prototype.h=null;var vn,wn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function bn(){jt.call(this,"d")}function En(){jt.call(this,"c")}function In(){}function Tn(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new Ye(this),this.P=An,t=Zt?125:void 0,this.V=new Ke(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Sn}function Sn(){this.i=null,this.g="",this.h=!1}Pt(bn,jt),Pt(En,jt),Pt(In,gn),In.prototype.g=function(){return new XMLHttpRequest},In.prototype.i=function(){return{}},vn=new In;var An=45e3,Cn={},Dn={};function _n(t,e,n){t.L=1,t.v=Gn($n(e)),t.s=n,t.S=!0,Nn(t,null)}function Nn(t,e){t.G=Date.now(),Ln(t),t.A=$n(t.v);var n=t.A,i=t.W;Array.isArray(i)||(i=[String(i)]),oi(n.i,"t",i),t.C=0,n=t.l.J,t.h=new Sn,t.g=rs(t.l,n?e:null,!t.s),0<t.O&&(t.M=new Xe(xt(t.Pa,t,t.g),t.O)),Ze(t.U,t.g,"readystatechange",t.nb),e=t.I?pe(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),cn(),function(t,e,n,i,s,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.W,t.s)}function kn(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.l.Ha}function On(t,e,n){let i,s=!0;for(;!t.J&&t.C<n.length;){if(i=Rn(t,n),i==Dn){4==e&&(t.o=4,un(14),s=!1),nn(t.j,t.m,null,"[Incomplete Response]");break}if(i==Cn){t.o=4,un(15),nn(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}nn(t.j,t.m,i,null),Vn(t,i)}kn(t)&&i!=Dn&&i!=Cn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,un(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yi(e),e.M=!0,un(11))):(nn(t.j,t.m,n,"[Invalid Chunked Response]"),Fn(t),Pn(t))}function Rn(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?Dn:(n=Number(e.substring(n,i)),isNaN(n)?Cn:(i+=1)+n>e.length?Dn:(e=e.slice(i,i+n),t.C=i+n,e))}function Ln(t){t.Y=Date.now()+t.P,xn(t,t.P)}function xn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=fn(xt(t.lb,t),e)}function Mn(t){t.B&&(Dt.clearTimeout(t.B),t.B=null)}function Pn(t){0==t.l.H||t.J||ts(t.l,t)}function Fn(t){Mn(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Ge(t.V),tn(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Vn(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||fi(n.i,t)))if(!t.K&&fi(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;Zi(n),qi(n)}Xi(n),un(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&0==n.A&&!n.v&&(n.v=fn(xt(n.ib,n),6e3));if(1>=hi(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else ns(n,11)}else if((t.K||n.g==t)&&Zi(n),!qt(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const e=l[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const s=l[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=i.i;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(di(r,r.h),r.h=null))}if(i.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,Kn(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=ss(i,i.J?i.pa:null,i.Y),o.K){pi(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.B&&(Mn(a),Ln(a)),i.g=o}else Wi(i);0<n.j.length&&Hi(n)}else"stop"!=l[0]&&"close"!=l[0]||ns(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?ns(n,7):$i(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}cn()}catch(t){}}function Un(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(_t(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(_t(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(_t(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),s=i.length,r=0;r<s;r++)e.call(void 0,i[r],n&&n[r],t)}(Tt=Tn.prototype).setTimeout=function(t){this.P=t},Tt.nb=function(t){t=t.target;const e=this.M;e&&3==Pi(t)?e.l():this.Pa(t)},Tt.Pa=function(t){try{if(t==this.g)t:{const u=Pi(this.g);var e=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||Zt||this.g&&(this.h.h||this.g.ja()||Fi(this.g)))){this.J||4!=u||7==e||cn(),Mn(this);var n=this.g.da();this.ca=n;e:if(kn(this)){var i=Fi(this.g);t="";var s=i.length,r=4==Pi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Fn(this),Pn(this);var o="";break e}this.h.i=new Dt.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:r&&e==s-1});i.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,s,r,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!qt(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.o=3,un(12),Fn(this),Pn(this);break t}nn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vn(this,n)}this.S?(On(this,u,o),Zt&&this.i&&3==u&&(Ze(this.U,this.V,"tick",this.mb),this.V.start())):(nn(this.j,this.m,o,null),Vn(this,o)),4==u&&Fn(this),this.i&&!this.J&&(4==u?ts(this.l,this):(this.i=!1,Ln(this)))}else(function(t){const e={};t=(t.g&&2<=Pi(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(qt(t[i]))continue;var n=Ue(t[i]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const r=e[s]||[];e[s]=r,r.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,un(12)):(this.o=0,un(13)),Fn(this),Pn(this)}}}catch(t){}},Tt.mb=function(){if(this.g){var t=Pi(this.g),e=this.g.ja();this.C<e.length&&(Mn(this),On(this,t,e),this.i&&4!=t&&Ln(this))}},Tt.cancel=function(){this.J=!0,Fn(this)},Tt.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.L&&(cn(),un(17)),Fn(this),this.o=2,Pn(this)):xn(this,this.Y-t)};var Bn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jn(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof jn){this.h=t.h,qn(this,t.j),this.s=t.s,this.g=t.g,zn(this,t.m),this.l=t.l;var e=t.i,n=new ni;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Hn(this,n),this.o=t.o}else t&&(e=String(t).match(Bn))?(this.h=!1,qn(this,e[1]||"",!0),this.s=Qn(e[2]||""),this.g=Qn(e[3]||"",!0),zn(this,e[4]),this.l=Qn(e[5]||"",!0),Hn(this,e[6]||"",!0),this.o=Qn(e[7]||"")):(this.h=!1,this.i=new ni(null,this.h))}function $n(t){return new jn(t)}function qn(t,e,n){t.j=n?Qn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function zn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Hn(t,e,n){e instanceof ni?(t.i=e,function(t,e){e&&!t.j&&(ii(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(si(this,e),oi(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Wn(e,ti)),t.i=new ni(e,t.h))}function Kn(t,e,n){t.i.set(e,n)}function Gn(t){return Kn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Qn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Xn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Xn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}jn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Wn(e,Yn,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Wn(e,Yn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Wn(n,"/"==n.charAt(0)?Zn:Jn,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Wn(n,ei)),t.join("")};var Yn=/[#\/\?@]/g,Jn=/[#\?:]/g,Zn=/[#\?]/g,ti=/[#\?@]/g,ei=/#/g;function ni(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ii(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var r=t[n].substring(0,i);s=t[n].substring(i+1)}else r=t[n];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function si(t,e){ii(t),e=ai(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ri(t,e){return ii(t),e=ai(t,e),t.g.has(e)}function oi(t,e,n){si(t,e),0<n.length&&(t.i=null,t.g.set(ai(t,e),Ut(n)),t.h+=n.length)}function ai(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function ci(t){this.l=t||li,t=Dt.PerformanceNavigationTiming?0<(t=Dt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Dt.g&&Dt.g.Ka&&Dt.g.Ka()&&Dt.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Tt=ni.prototype).add=function(t,e){ii(this),this.i=null,t=ai(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Tt.forEach=function(t,e){ii(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},Tt.ta=function(){ii(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const s=t[i];for(let t=0;t<s.length;t++)n.push(e[i])}return n},Tt.Z=function(t){ii(this);let e=[];if("string"==typeof t)ri(this,t)&&(e=e.concat(this.g.get(ai(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},Tt.set=function(t,e){return ii(this),this.i=null,ri(this,t=ai(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Tt.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Tt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const r=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var s=r;""!==o[i]&&(s+="="+encodeURIComponent(String(o[i]))),t.push(s)}}return this.i=t.join("&")};var li=10;function ui(t){return!!t.h||!!t.g&&t.g.size>=t.j}function hi(t){return t.h?1:t.g?t.g.size:0}function fi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function di(t,e){t.g?t.g.add(e):t.h=e}function pi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function gi(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Ut(t.i)}ci.prototype.cancel=function(){if(this.i=gi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var mi=class{stringify(t){return Dt.JSON.stringify(t,void 0)}parse(t){return Dt.JSON.parse(t,void 0)}};function yi(){this.g=new mi}function vi(t,e,n){const i=n||"";try{Un(t,(function(t,n){let s=t;Nt(t)&&(s=Me(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function wi(t,e,n,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(t){}}function bi(t){this.l=t.fc||null,this.j=t.ob||!1}function Ei(t,e){Re.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Ii,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Pt(bi,gn),bi.prototype.g=function(){return new Ei(this.l,this.j)},bi.prototype.i=function(t){return function(){return t}}({}),Pt(Ei,Re);var Ii=0;function Ti(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Si(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ai(t)}function Ai(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Tt=Ei.prototype).open=function(t,e){if(this.readyState!=Ii)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ai(this)},Tt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Dt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Tt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Si(this)),this.readyState=Ii},Tt.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ai(this)),this.g&&(this.readyState=3,Ai(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Dt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ti(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Tt.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Si(this):Ai(this),3==this.readyState&&Ti(this)}},Tt.Za=function(t){this.g&&(this.response=this.responseText=t,Si(this))},Tt.Ya=function(t){this.g&&(this.response=t,Si(this))},Tt.ka=function(){this.g&&Si(this)},Tt.setRequestHeader=function(t,e){this.v.append(t,e)},Tt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Tt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ei.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Ci=Dt.JSON.parse;function Di(t){Re.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=_i,this.L=this.M=!1}Pt(Di,Re);var _i="",Ni=/^https?$/i,ki=["POST","PUT"];function Oi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ri(t),xi(t)}function Ri(t){t.F||(t.F=!0,Le(t,"complete"),Le(t,"error"))}function Li(t){if(t.h&&void 0!==Ct&&(!t.C[1]||4!=Pi(t)||2!=t.da()))if(t.v&&4==Pi(t))Qe(t.La,0,t);else if(Le(t,"readystatechange"),4==Pi(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var s=String(t.I).match(Bn)[1]||null;!s&&Dt.self&&Dt.self.location&&(s=Dt.self.location.protocol.slice(0,-1)),i=!Ni.test(s?s.toLowerCase():"")}n=i}if(n)Le(t,"complete"),Le(t,"success");else{t.m=6;try{var r=2<Pi(t)?t.g.statusText:""}catch(t){r=""}t.j=r+" ["+t.da()+"]",Ri(t)}}finally{xi(t)}}}function xi(t,e){if(t.g){Mi(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Le(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Mi(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Dt.clearTimeout(t.A),t.A=null)}function Pi(t){return t.g?t.g.readyState:0}function Fi(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case _i:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Vi(t){let e="";return de(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Ui(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Vi(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Kn(t,e,n))}function Bi(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ji(t){this.Ga=0,this.j=[],this.l=new en,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Bi("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Bi("baseRetryDelayMs",5e3,t),this.hb=Bi("retryDelaySeedMs",1e4,t),this.eb=Bi("forwardChannelMaxRetries",2,t),this.xa=Bi("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new ci(t&&t.concurrentRequestLimit),this.Ja=new yi,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function $i(t){if(zi(t),3==t.H){var e=t.W++,n=$n(t.I);if(Kn(n,"SID",t.K),Kn(n,"RID",e),Kn(n,"TYPE","terminate"),Gi(t,n),(e=new Tn(t,t.l,e)).L=2,e.v=Gn($n(n)),n=!1,Dt.navigator&&Dt.navigator.sendBeacon)try{n=Dt.navigator.sendBeacon(e.v.toString(),"")}catch(t){}!n&&Dt.Image&&((new Image).src=e.v,n=!0),n||(e.g=rs(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Ln(e)}is(t)}function qi(t){t.g&&(Yi(t),t.g.cancel(),t.g=null)}function zi(t){qi(t),t.u&&(Dt.clearTimeout(t.u),t.u=null),Zi(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Dt.clearTimeout(t.m),t.m=null)}function Hi(t){if(!ui(t.i)&&!t.m){t.m=!0;var e=t.Na;je||ze(),$e||(je(),$e=!0),qe.add(e,t),t.C=0}}function Ki(t,e){var n;n=e?e.m:t.W++;const i=$n(t.I);Kn(i,"SID",t.K),Kn(i,"RID",n),Kn(i,"AID",t.V),Gi(t,i),t.o&&t.s&&Ui(i,t.o,t.s),n=new Tn(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Qi(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),di(t.i,n),_n(n,i,e)}function Gi(t,e){t.na&&de(t.na,(function(t,n){Kn(e,n,t)})),t.h&&Un({},(function(t,n){Kn(e,n,t)}))}function Qi(t,e,n){n=Math.min(t.j.length,n);var i=t.h?xt(t.h.Va,t.h,t):null;t:{var s=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let r=!0;for(let o=0;o<n;o++){let n=s[o].g;const a=s[o].map;if(n-=e,0>n)e=Math.max(0,s[o].g-100),r=!1;else try{vi(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(r){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function Wi(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;je||ze(),$e||(je(),$e=!0),qe.add(e,t),t.A=0}}function Xi(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=fn(xt(t.Ma,t),es(t,t.A)),t.A++,0))}function Yi(t){null!=t.B&&(Dt.clearTimeout(t.B),t.B=null)}function Ji(t){t.g=new Tn(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=$n(t.wa);Kn(e,"RID","rpc"),Kn(e,"SID",t.K),Kn(e,"AID",t.V),Kn(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Kn(e,"TO",t.qa),Kn(e,"TYPE","xmlhttp"),Gi(t,e),t.o&&t.s&&Ui(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Gn($n(e)),n.s=null,n.S=!0,Nn(n,t)}function Zi(t){null!=t.v&&(Dt.clearTimeout(t.v),t.v=null)}function ts(t,e){var n=null;if(t.g==e){Zi(t),Yi(t),t.g=null;var i=2}else{if(!fi(t.i,e))return;n=e.F,pi(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;Le(i=on(),new hn(i,n)),Hi(t)}else Wi(t);else if(3==(s=e.o)||0==s&&0<e.ca||!(1==i&&function(t,e){return!(hi(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=fn(xt(t.Na,t,e),es(t,t.C)),t.C++,0)))}(t,e)||2==i&&Xi(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:ns(t,5);break;case 4:ns(t,10);break;case 3:ns(t,6);break;default:ns(t,2)}}function es(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ns(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=xt(t.pb,t);n||(n=new jn("//www.google.com/images/cleardot.gif"),Dt.location&&"http"==Dt.location.protocol||qn(n,"https"),Gn(n)),function(t,e){const n=new en;if(Dt.Image){const i=new Image;i.onload=Mt(wi,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Mt(wi,n,i,"TestLoadImage: error",!1,e),i.onabort=Mt(wi,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Mt(wi,n,i,"TestLoadImage: timeout",!1,e),Dt.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else un(2);t.H=0,t.h&&t.h.za(e),is(t),zi(t)}function is(t){if(t.H=0,t.ma=[],t.h){const e=gi(t.i);0==e.length&&0==t.j.length||(Bt(t.ma,e),Bt(t.ma,t.j),t.i.i.length=0,Ut(t.j),t.j.length=0),t.h.ya()}}function ss(t,e,n){var i=n instanceof jn?$n(n):new jn(n);if(""!=i.g)e&&(i.g=e+"."+i.g),zn(i,i.m);else{var s=Dt.location;i=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var r=new jn(null);i&&qn(r,i),e&&(r.g=e),s&&zn(r,s),n&&(r.l=n),i=r}return n=t.F,e=t.Da,n&&e&&Kn(i,n,e),Kn(i,"VER",t.ra),Gi(t,i),i}function rs(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ha&&!t.va?new Di(new bi({ob:!0})):new Di(t.va)).Oa(t.J),e}function os(){}function as(){if(Yt&&!(10<=Number(oe)))throw Error("Environmental error: no available transport.")}function cs(t,e){Re.call(this),this.g=new ji(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!qt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!qt(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new hs(this)}function ls(t){bn.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function us(){En.call(this),this.status=1}function hs(t){this.g=t}function fs(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ds(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var s=0;16>s;++s)i[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)i[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var r=t.g[3],o=e+(r^n&(s^r))+i[0]+3614090360&4294967295;o=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=n+(o<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(s^r))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(s^r))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(s^r))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^r&(n^s))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^r&(n^s))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^r&(n^s))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^r&(n^s))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^s^r)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^r)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^r)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^r)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(s^(n|~r))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(r|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(s^(n|~r))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(r|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(s^(n|~r))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(r|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((r=(e=n+((o=e+(s^(n|~r))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((s=r+((o=s+(e^(r|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+r&4294967295}function ps(t,e){this.h=e;for(var n=[],i=!0,s=t.length-1;0<=s;s--){var r=0|t[s];i&&r==e||(n[s]=r,i=!1)}this.g=n}(Tt=Di.prototype).Oa=function(t){this.M=t},Tt.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():vn.g(),this.C=this.u?mn(this.u):mn(vn),this.g.onreadystatechange=xt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Oi(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),s=Dt.FormData&&t instanceof Dt.FormData,!(0<=Vt(ki,e))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Mi(this),0<this.B&&((this.L=function(t){return Yt&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=xt(this.ua,this)):this.A=Qe(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Oi(this,t)}},Tt.ua=function(){void 0!==Ct&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Le(this,"timeout"),this.abort(8))},Tt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Le(this,"complete"),Le(this,"abort"),xi(this))},Tt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),xi(this,!0)),Di.$.N.call(this)},Tt.La=function(){this.s||(this.G||this.v||this.l?Li(this):this.kb())},Tt.kb=function(){Li(this)},Tt.isActive=function(){return!!this.g},Tt.da=function(){try{return 2<Pi(this)?this.g.status:-1}catch(t){return-1}},Tt.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Tt.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ci(e)}},Tt.Ia=function(){return this.m},Tt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Tt=ji.prototype).ra=8,Tt.H=1,Tt.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new Tn(this,this.l,t);let r=this.s;if(this.U&&(r?(r=pe(r),me(r,this.U)):r=this.U),null!==this.o||this.O||(s.I=r,r=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Qi(this,s,e),Kn(n=$n(this.I),"RID",t),Kn(n,"CVER",22),this.F&&Kn(n,"X-HTTP-Session-Id",this.F),Gi(this,n),r&&(this.O?e="headers="+encodeURIComponent(String(Vi(r)))+"&"+e:this.o&&Ui(n,this.o,r)),di(this.i,s),this.bb&&Kn(n,"TYPE","init"),this.P?(Kn(n,"$req",e),Kn(n,"SID","null"),s.aa=!0,_n(s,n,null)):_n(s,n,e),this.H=2}}else 3==this.H&&(t?Ki(this,t):0==this.j.length||ui(this.i)||Ki(this))},Tt.Ma=function(){if(this.u=null,Ji(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=fn(xt(this.jb,this),t)}},Tt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,un(10),qi(this),Ji(this))},Tt.ib=function(){null!=this.v&&(this.v=null,qi(this),Xi(this),un(19))},Tt.pb=function(t){t?(this.l.info("Successfully pinged google.com"),un(2)):(this.l.info("Failed to ping google.com"),un(1))},Tt.isActive=function(){return!!this.h&&this.h.isActive(this)},(Tt=os.prototype).Ba=function(){},Tt.Aa=function(){},Tt.za=function(){},Tt.ya=function(){},Tt.isActive=function(){return!0},Tt.Va=function(){},as.prototype.g=function(t,e){return new cs(t,e)},Pt(cs,Re),cs.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;un(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=ss(t,null,t.Y),Hi(t)},cs.prototype.close=function(){$i(this.g)},cs.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Me(t),t=n);e.j.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.fb++,t)),3==e.H&&Hi(e)},cs.prototype.N=function(){this.g.h=null,delete this.j,$i(this.g),delete this.g,cs.$.N.call(this)},Pt(ls,bn),Pt(us,En),Pt(hs,os),hs.prototype.Ba=function(){Le(this.g,"a")},hs.prototype.Aa=function(t){Le(this.g,new ls(t))},hs.prototype.za=function(t){Le(this.g,new us)},hs.prototype.ya=function(){Le(this.g,"b")},Pt(fs,(function(){this.blockSize=-1})),fs.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},fs.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,s=this.h,r=0;r<e;){if(0==s)for(;r<=n;)ds(this,t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[s++]=t.charCodeAt(r++),s==this.blockSize){ds(this,i),s=0;break}}else for(;r<e;)if(i[s++]=t[r++],s==this.blockSize){ds(this,i),s=0;break}}this.h=s,this.i+=e},fs.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var gs={};function ms(t){return-128<=t&&128>t?function(t,e){var n=gs;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new ps([0|t],0>t?-1:0)}(t)}(t):new ps([0|t],0>t?-1:0)}function ys(t){if(isNaN(t)||!isFinite(t))return ws;if(0>t)return Ss(ys(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=vs;return new ps(e,0)}var vs=4294967296,ws=ms(0),bs=ms(1),Es=ms(16777216);function Is(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Ts(t){return-1==t.h}function Ss(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new ps(n,~t.h).add(bs)}function As(t,e){return t.add(Ss(e))}function Cs(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ds(t,e){this.g=t,this.h=e}function _s(t,e){if(Is(e))throw Error("division by zero");if(Is(t))return new Ds(ws,ws);if(Ts(t))return e=_s(Ss(t),e),new Ds(Ss(e.g),Ss(e.h));if(Ts(e))return e=_s(t,Ss(e)),new Ds(Ss(e.g),e.h);if(30<t.g.length){if(Ts(t)||Ts(e))throw Error("slowDivide_ only works with positive integers.");for(var n=bs,i=e;0>=i.X(t);)n=Ns(n),i=Ns(i);var s=ks(n,1),r=ks(i,1);for(i=ks(i,2),n=ks(n,2);!Is(i);){var o=r.add(i);0>=o.X(t)&&(s=s.add(n),r=o),i=ks(i,1),n=ks(n,1)}return e=As(t,s.R(e)),new Ds(s,e)}for(s=ws;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(r=ys(n)).R(e);Ts(o)||0<o.X(t);)o=(r=ys(n-=i)).R(e);Is(r)&&(r=bs),s=s.add(r),t=As(t,o)}return new Ds(s,t)}function Ns(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new ps(n,t.h)}function ks(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,s=[],r=0;r<i;r++)s[r]=0<e?t.D(r+n)>>>e|t.D(r+n+1)<<32-e:t.D(r+n);return new ps(s,t.h)}(Tt=ps.prototype).ea=function(){if(Ts(this))return-Ss(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:vs+i)*e,e*=vs}return t},Tt.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Is(this))return"0";if(Ts(this))return"-"+Ss(this).toString(t);for(var e=ys(Math.pow(t,6)),n=this,i="";;){var s=_s(n,e).g,r=((0<(n=As(n,s.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Is(n=s))return r+i;for(;6>r.length;)r="0"+r;i=r+i}},Tt.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Tt.X=function(t){return Ts(t=As(this,t))?-1:Is(t)?0:1},Tt.abs=function(){return Ts(this)?Ss(this):this},Tt.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,s=0;s<=e;s++){var r=i+(65535&this.D(s))+(65535&t.D(s)),o=(r>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);i=o>>>16,r&=65535,o&=65535,n[s]=o<<16|r}return new ps(n,-2147483648&n[n.length-1]?-1:0)},Tt.R=function(t){if(Is(this)||Is(t))return ws;if(Ts(this))return Ts(t)?Ss(this).R(Ss(t)):Ss(Ss(this).R(t));if(Ts(t))return Ss(this.R(Ss(t)));if(0>this.X(Es)&&0>t.X(Es))return ys(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<t.g.length;s++){var r=this.D(i)>>>16,o=65535&this.D(i),a=t.D(s)>>>16,c=65535&t.D(s);n[2*i+2*s]+=o*c,Cs(n,2*i+2*s),n[2*i+2*s+1]+=r*c,Cs(n,2*i+2*s+1),n[2*i+2*s+1]+=o*a,Cs(n,2*i+2*s+1),n[2*i+2*s+2]+=r*a,Cs(n,2*i+2*s+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new ps(n,0)},Tt.gb=function(t){return _s(this,t).h},Tt.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new ps(n,this.h&t.h)},Tt.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new ps(n,this.h|t.h)},Tt.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new ps(n,this.h^t.h)},as.prototype.createWebChannel=as.prototype.g,cs.prototype.send=cs.prototype.u,cs.prototype.open=cs.prototype.m,cs.prototype.close=cs.prototype.close,dn.NO_ERROR=0,dn.TIMEOUT=8,dn.HTTP_ERROR=6,pn.COMPLETE="complete",yn.EventType=wn,wn.OPEN="a",wn.CLOSE="b",wn.ERROR="c",wn.MESSAGE="d",Re.prototype.listen=Re.prototype.O,Di.prototype.listenOnce=Di.prototype.P,Di.prototype.getLastError=Di.prototype.Sa,Di.prototype.getLastErrorCode=Di.prototype.Ia,Di.prototype.getStatus=Di.prototype.da,Di.prototype.getResponseJson=Di.prototype.Wa,Di.prototype.getResponseText=Di.prototype.ja,Di.prototype.send=Di.prototype.ha,Di.prototype.setWithCredentials=Di.prototype.Oa,fs.prototype.digest=fs.prototype.l,fs.prototype.reset=fs.prototype.reset,fs.prototype.update=fs.prototype.j,ps.prototype.add=ps.prototype.add,ps.prototype.multiply=ps.prototype.R,ps.prototype.modulo=ps.prototype.gb,ps.prototype.compare=ps.prototype.X,ps.prototype.toNumber=ps.prototype.ea,ps.prototype.toString=ps.prototype.toString,ps.prototype.getBits=ps.prototype.D,ps.fromNumber=ys,ps.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return Ss(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=ys(Math.pow(n,8)),s=ws,r=0;r<e.length;r+=8){var o=Math.min(8,e.length-r),a=parseInt(e.substring(r,r+o),n);8>o?(o=ys(Math.pow(n,o)),s=s.R(o).add(ys(a))):s=(s=s.R(i)).add(ys(a))}return s};var Os=At.createWebChannelTransport=function(){return new as},Rs=At.getStatEventTarget=function(){return on()},Ls=At.ErrorCode=dn,xs=At.EventType=pn,Ms=At.Event=sn,Ps=At.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Fs=At.FetchXmlHttpFactory=bi,Vs=At.WebChannel=yn,Us=At.XhrIo=Di,Bs=(At.Md5=fs,At.Integer=ps);const js="@firebase/firestore";class $s{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}$s.UNAUTHENTICATED=new $s(null),$s.GOOGLE_CREDENTIALS=new $s("google-credentials-uid"),$s.FIRST_PARTY=new $s("first-party-uid"),$s.MOCK_USER=new $s("mock-user");let qs="9.22.1";const zs=new R("@firebase/firestore");function Hs(){return zs.logLevel}function Ks(t,...e){if(zs.logLevel<=C.DEBUG){const n=e.map(Ws);zs.debug(`Firestore (${qs}): ${t}`,...n)}}function Gs(t,...e){if(zs.logLevel<=C.ERROR){const n=e.map(Ws);zs.error(`Firestore (${qs}): ${t}`,...n)}}function Qs(t,...e){if(zs.logLevel<=C.WARN){const n=e.map(Ws);zs.warn(`Firestore (${qs}): ${t}`,...n)}}function Ws(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Xs(t="Unexpected state"){const e=`FIRESTORE (${qs}) INTERNAL ASSERTION FAILED: `+t;throw Gs(e),new Error(e)}function Ys(t,e){t||Xs()}function Js(t,e){return t}const Zs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tr extends u{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class er{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class nr{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ir{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e($s.UNAUTHENTICATED)))}shutdown(){}}class sr{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class rr{constructor(t){this.t=t,this.currentUser=$s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new er;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new er,t.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Ks("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Ks("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new er)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ks("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Ys("string"==typeof e.accessToken),new nr(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Ys(null===t||"string"==typeof t),new $s(t)}}class or{constructor(t,e,n){this.h=t,this.l=e,this.m=n,this.type="FirstParty",this.user=$s.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const t=this.p();return t&&this.g.set("Authorization",t),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class ar{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new or(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e($s.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class cr{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lr{constructor(t){this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(t,e){const n=t=>{null!=t.error&&Ks("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.T;return this.T=t.token,Ks("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Ks("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.I.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.I.getImmediate({optional:!0});t?i(t):Ks("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Ys("string"==typeof t.token),this.T=t.token,new cr(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function ur(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class hr{static A(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=ur(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function fr(t,e){return t<e?-1:t>e?1:0}function dr(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class pr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new tr(Zs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new tr(Zs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new tr(Zs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new tr(Zs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return pr.fromMillis(Date.now())}static fromDate(t){return pr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new pr(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?fr(this.nanoseconds,t.nanoseconds):fr(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class gr{constructor(t){this.timestamp=t}static fromTimestamp(t){return new gr(t)}static min(){return new gr(new pr(0,0))}static max(){return new gr(new pr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class mr{constructor(t,e,n){void 0===e?e=0:e>t.length&&Xs(),void 0===n?n=t.length-e:n>t.length-e&&Xs(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===mr.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof mr?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),s=e.get(i);if(n<s)return-1;if(n>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class yr extends mr{construct(t,e,n){return new yr(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new tr(Zs.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new yr(e)}static emptyPath(){return new yr([])}}const vr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wr extends mr{construct(t,e,n){return new wr(t,e,n)}static isValidIdentifier(t){return vr.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wr.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new wr(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new tr(Zs.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new tr(Zs.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new tr(Zs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(r=!r,i++):"."!==e||r?(n+=e,i++):(s(),i++)}if(s(),r)throw new tr(Zs.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new wr(e)}static emptyPath(){return new wr([])}}class br{constructor(t){this.path=t}static fromPath(t){return new br(yr.fromString(t))}static fromName(t){return new br(yr.fromString(t).popFirst(5))}static empty(){return new br(yr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===yr.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return yr.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new br(new yr(t.slice()))}}function Er(t){return new Ir(t.readTime,t.key,-1)}class Ir{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Ir(gr.min(),br.empty(),-1)}static max(){return new Ir(gr.max(),br.empty(),-1)}}function Tr(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=br.comparator(t.documentKey,e.documentKey),0!==n?n:fr(t.largestBatchId,e.largestBatchId))}const Sr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ar{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Cr(t){if(t.code!==Zs.FAILED_PRECONDITION||t.message!==Sr)throw t;Ks("LocalStore","Unexpectedly lost primary lease")}class Dr{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Xs(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Dr(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Dr?e:Dr.resolve(e)}catch(t){return Dr.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Dr.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Dr.reject(e)}static resolve(t){return new Dr(((e,n)=>{e(t)}))}static reject(t){return new Dr(((e,n)=>{n(t)}))}static waitFor(t){return new Dr(((e,n)=>{let i=0,s=0,r=!1;t.forEach((t=>{++i,t.next((()=>{++s,r&&s===i&&e()}),(t=>n(t)))})),r=!0,s===i&&e()}))}static or(t){let e=Dr.resolve(!1);for(const n of t)e=e.next((t=>t?Dr.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Dr(((n,i)=>{const s=t.length,r=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;e(t[c]).next((t=>{r[c]=t,++o,o===s&&n(r)}),(t=>i(t)))}}))}static doWhile(t,e){return new Dr(((n,i)=>{const s=()=>{!0===t()?e().next((()=>{s()}),i):n()};s()}))}}function _r(t){return"IndexedDbTransactionError"===t.name}class Nr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ot(t),this.ut=t=>e.writeSequenceNumber(t))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}function kr(t){return null==t}function Or(t){return 0===t&&1/t==-1/0}Nr.ct=-1;function Rr(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Lr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xr(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Mr{constructor(t,e){this.comparator=t,this.root=e||Fr.EMPTY}insert(t,e){return new Mr(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Fr.BLACK,null,null))}remove(t){return new Mr(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Fr.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Pr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Pr(this.root,t,this.comparator,!1)}getReverseIterator(){return new Pr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Pr(this.root,t,this.comparator,!0)}}class Pr{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Fr{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:Fr.RED,this.left=null!=i?i:Fr.EMPTY,this.right=null!=s?s:Fr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new Fr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Fr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return Fr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xs();if(this.right.isRed())throw Xs();const t=this.left.check();if(t!==this.right.check())throw Xs();return t+(this.isRed()?0:1)}}Fr.EMPTY=null,Fr.RED=!0,Fr.BLACK=!1,Fr.EMPTY=new class{constructor(){this.size=0}get key(){throw Xs()}get value(){throw Xs()}get color(){throw Xs()}get left(){throw Xs()}get right(){throw Xs()}copy(t,e,n,i,s){return this}insert(t,e,n){return new Fr(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Vr{constructor(t){this.comparator=t,this.data=new Mr(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Ur(this.data.getIterator())}getIteratorFrom(t){return new Ur(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Vr))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Vr(this.comparator);return e.data=t,e}}class Ur{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Br{constructor(t){this.fields=t,t.sort(wr.comparator)}static empty(){return new Br([])}unionWith(t){let e=new Vr(wr.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Br(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return dr(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class jr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class $r{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new jr("Invalid base64 string: "+t):t}}(t);return new $r(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new $r(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return fr(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}$r.EMPTY_BYTE_STRING=new $r("");const qr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zr(t){if(Ys(!!t),"string"==typeof t){let e=0;const n=qr.exec(t);if(Ys(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Hr(t.seconds),nanos:Hr(t.nanos)}}function Hr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Kr(t){return"string"==typeof t?$r.fromBase64String(t):$r.fromUint8Array(t)}function Gr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Qr(t){const e=t.mapValue.fields.__previous_value__;return Gr(e)?Qr(e):e}function Wr(t){const e=zr(t.mapValue.fields.__local_write_time__.timestampValue);return new pr(e.seconds,e.nanos)}class Xr{constructor(t,e,n,i,s,r,o,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class Yr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Yr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Yr&&t.projectId===this.projectId&&t.database===this.database}}const Jr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Zr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gr(t)?4:uo(t)?9007199254740991:10:Xs()}function to(t,e){if(t===e)return!0;const n=Zr(t);if(n!==Zr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wr(t).isEqual(Wr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=zr(t.timestampValue),i=zr(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Kr(t.bytesValue).isEqual(Kr(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Hr(t.geoPointValue.latitude)===Hr(e.geoPointValue.latitude)&&Hr(t.geoPointValue.longitude)===Hr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Hr(t.integerValue)===Hr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Hr(t.doubleValue),i=Hr(e.doubleValue);return n===i?Or(n)===Or(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return dr(t.arrayValue.values||[],e.arrayValue.values||[],to);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Rr(n)!==Rr(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!to(n[t],i[t])))return!1;return!0}(t,e);default:return Xs()}}function eo(t,e){return void 0!==(t.values||[]).find((t=>to(t,e)))}function no(t,e){if(t===e)return 0;const n=Zr(t),i=Zr(e);if(n!==i)return fr(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return fr(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Hr(t.integerValue||t.doubleValue),i=Hr(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return io(t.timestampValue,e.timestampValue);case 4:return io(Wr(t),Wr(e));case 5:return fr(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Kr(t),i=Kr(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=fr(n[t],i[t]);if(0!==e)return e}return fr(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=fr(Hr(t.latitude),Hr(e.latitude));return 0!==n?n:fr(Hr(t.longitude),Hr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=no(n[t],i[t]);if(e)return e}return fr(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Jr.mapValue&&e===Jr.mapValue)return 0;if(t===Jr.mapValue)return 1;if(e===Jr.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let t=0;t<i.length&&t<r.length;++t){const e=fr(i[t],r[t]);if(0!==e)return e;const o=no(n[i[t]],s[r[t]]);if(0!==o)return o}return fr(i.length,r.length)}(t.mapValue,e.mapValue);default:throw Xs()}}function io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return fr(t,e);const n=zr(t),i=zr(e),s=fr(n.seconds,i.seconds);return 0!==s?s:fr(n.nanos,i.nanos)}function so(t){return ro(t)}function ro(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=zr(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Kr(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,br.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=ro(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+=`${s}:${ro(t.fields[s])}`;return n+"}"}(t.mapValue):Xs();var e,n}function oo(t){return!!t&&"integerValue"in t}function ao(t){return!!t&&"arrayValue"in t}function co(t){return!!t&&"mapValue"in t}function lo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Lr(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=lo(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=lo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function uo(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class ho{constructor(t){this.value=t}static empty(){return new ho({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!co(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=lo(e)}setAll(t){let e=wr.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=lo(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());co(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return to(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];co(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){Lr(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new ho(lo(this.value))}}function fo(t){const e=[];return Lr(t.fields,((t,n)=>{const i=new wr([t]);if(co(n)){const t=fo(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new Br(e)}class po{constructor(t,e,n,i,s,r,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=s,this.data=r,this.documentState=o}static newInvalidDocument(t){return new po(t,0,gr.min(),gr.min(),gr.min(),ho.empty(),0)}static newFoundDocument(t,e,n,i){return new po(t,1,e,gr.min(),n,i,0)}static newNoDocument(t,e){return new po(t,2,e,gr.min(),gr.min(),ho.empty(),0)}static newUnknownDocument(t,e){return new po(t,3,e,gr.min(),gr.min(),ho.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(gr.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ho.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ho.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gr.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof po&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new po(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class go{constructor(t,e){this.position=t,this.inclusive=e}}function mo(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const r=e[s],o=t.position[s];if(i=r.field.isKeyField()?br.comparator(br.fromName(o.referenceValue),n.key):no(o,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function yo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!to(t.position[n],e.position[n]))return!1;return!0}class vo{constructor(t,e="asc"){this.field=t,this.dir=e}}function wo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class bo{}class Eo extends bo{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new _o(t,e,n):"array-contains"===e?new Ro(t,n):"in"===e?new Lo(t,n):"not-in"===e?new xo(t,n):"array-contains-any"===e?new Mo(t,n):new Eo(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new No(t,n):new ko(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(no(e,this.value)):null!==e&&Zr(this.value)===Zr(e)&&this.matchesComparison(no(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Xs()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Io extends bo{constructor(t,e){super(),this.filters=t,this.op=e,this.lt=null}static create(t,e){return new Io(t,e)}matches(t){return To(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.ft((t=>t.isInequality()));return null!==t?t.field:null}ft(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function To(t){return"and"===t.op}function So(t){return function(t){for(const e of t.filters)if(e instanceof Io)return!1;return!0}(t)&&To(t)}function Ao(t){if(t instanceof Eo)return t.field.canonicalString()+t.op.toString()+so(t.value);if(So(t))return t.filters.map((t=>Ao(t))).join(",");{const e=t.filters.map((t=>Ao(t))).join(",");return`${t.op}(${e})`}}function Co(t,e){return t instanceof Eo?function(t,e){return e instanceof Eo&&t.op===e.op&&t.field.isEqual(e.field)&&to(t.value,e.value)}(t,e):t instanceof Io?function(t,e){return e instanceof Io&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&Co(n,e.filters[i])),!0)}(t,e):void Xs()}function Do(t){return t instanceof Eo?function(t){return`${t.field.canonicalString()} ${t.op} ${so(t.value)}`}(t):t instanceof Io?function(t){return t.op.toString()+" {"+t.getFilters().map(Do).join(" ,")+"}"}(t):"Filter"}class _o extends Eo{constructor(t,e,n){super(t,e,n),this.key=br.fromName(n.referenceValue)}matches(t){const e=br.comparator(t.key,this.key);return this.matchesComparison(e)}}class No extends Eo{constructor(t,e){super(t,"in",e),this.keys=Oo(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class ko extends Eo{constructor(t,e){super(t,"not-in",e),this.keys=Oo(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Oo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>br.fromName(t.referenceValue)))}class Ro extends Eo{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ao(e)&&eo(e.arrayValue,this.value)}}class Lo extends Eo{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&eo(this.value.arrayValue,e)}}class xo extends Eo{constructor(t,e){super(t,"not-in",e)}matches(t){if(eo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!eo(this.value.arrayValue,e)}}class Mo extends Eo{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ao(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>eo(this.value.arrayValue,t)))}}class Po{constructor(t,e=null,n=[],i=[],s=null,r=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=o,this.dt=null}}function Fo(t,e=null,n=[],i=[],s=null,r=null,o=null){return new Po(t,e,n,i,s,r,o)}function Vo(t){const e=Js(t);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Ao(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),kr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>so(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>so(t))).join(",")),e.dt=t}return e.dt}function Uo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!wo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Co(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yo(t.startAt,e.startAt)&&yo(t.endAt,e.endAt)}class Bo{constructor(t,e=null,n=[],i=[],s=null,r="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function jo(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function $o(t){const e=Js(t);if(null===e.wt){e.wt=[];const t=function(t){for(const e of t.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new vo(t)),e.wt.push(new vo(wr.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.wt.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new vo(wr.keyField(),t))}}}return e.wt}function qo(t){const e=Js(t);if(!e._t)if("F"===e.limitType)e._t=Fo(e.path,e.collectionGroup,$o(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of $o(e)){const e="desc"===n.dir?"asc":"desc";t.push(new vo(n.field,e))}const n=e.endAt?new go(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new go(e.startAt.position,e.startAt.inclusive):null;e._t=Fo(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function zo(t,e,n){return new Bo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ho(t,e){return Uo(qo(t),qo(e))&&t.limitType===e.limitType}function Ko(t){return`${Vo(qo(t))}|lt:${t.limitType}`}function Go(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Do(t))).join(", ")}]`),kr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>so(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>so(t))).join(",")),`Target(${e})`}(qo(t))}; limitType=${t.limitType})`}function Qo(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):br.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of $o(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=mo(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,$o(t),e)||t.endAt&&!function(t,e,n){const i=mo(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,$o(t),e))}(t,e)}function Wo(t,e,n){const i=t.field.isKeyField()?br.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?no(i,s):Xs()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Xs()}}class Xo{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Lr(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return xr(this.inner)}size(){return this.innerSize}}const Yo=new Mr(br.comparator);function Jo(){return Yo}const Zo=new Mr(br.comparator);function ta(...t){let e=Zo;for(const n of t)e=e.insert(n.key,n);return e}function ea(t){let e=Zo;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function na(){return sa()}function ia(){return sa()}function sa(){return new Xo((t=>t.toString()),((t,e)=>t.isEqual(e)))}const ra=new Mr(br.comparator),oa=new Vr(br.comparator);function aa(...t){let e=oa;for(const n of t)e=e.add(n);return e}const ca=new Vr(fr);function la(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Or(e)?"-0":e}}function ua(t){return{integerValue:""+t}}function ha(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Or(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?ua(e):la(t,e)}class fa{constructor(){this._=void 0}}function da(t,e,n){return t instanceof ma?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Gr(e)&&(e=Qr(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ya?va(t,e):t instanceof wa?ba(t,e):function(t,e){const n=ga(t,e),i=Ia(n)+Ia(t.gt);return oo(n)&&oo(t.gt)?ua(i):la(t.serializer,i)}(t,e)}function pa(t,e,n){return t instanceof ya?va(t,e):t instanceof wa?ba(t,e):n}function ga(t,e){return t instanceof Ea?oo(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class ma extends fa{}class ya extends fa{constructor(t){super(),this.elements=t}}function va(t,e){const n=Ta(e);for(const e of t.elements)n.some((t=>to(t,e)))||n.push(e);return{arrayValue:{values:n}}}class wa extends fa{constructor(t){super(),this.elements=t}}function ba(t,e){let n=Ta(e);for(const e of t.elements)n=n.filter((t=>!to(t,e)));return{arrayValue:{values:n}}}class Ea extends fa{constructor(t,e){super(),this.serializer=t,this.gt=e}}function Ia(t){return Hr(t.integerValue||t.doubleValue)}function Ta(t){return ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Sa{constructor(t,e){this.version=t,this.transformResults=e}}class Aa{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Aa}static exists(t){return new Aa(void 0,t)}static updateTime(t){return new Aa(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Ca(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Da{}function _a(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Va(t.key,Aa.none()):new La(t.key,t.data,Aa.none());{const n=t.data,i=ho.empty();let s=new Vr(wr.comparator);for(let t of e.fields)if(!s.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),s=s.add(t)}return new xa(t.key,i,new Br(s.toArray()),Aa.none())}}function Na(t,e,n){t instanceof La?function(t,e,n){const i=t.value.clone(),s=Pa(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof xa?function(t,e,n){if(!Ca(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Pa(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(Ma(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ka(t,e,n,i){return t instanceof La?function(t,e,n,i){if(!Ca(t.precondition,e))return n;const s=t.value.clone(),r=Fa(t.fieldTransforms,i,e);return s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null}(t,e,n,i):t instanceof xa?function(t,e,n,i){if(!Ca(t.precondition,e))return n;const s=Fa(t.fieldTransforms,i,e),r=e.data;return r.setAll(Ma(t)),r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return Ca(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Oa(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=ga(i.transform,t||null);null!=s&&(null===n&&(n=ho.empty()),n.set(i.field,s))}return n||null}function Ra(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&dr(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ya&&e instanceof ya||t instanceof wa&&e instanceof wa?dr(t.elements,e.elements,to):t instanceof Ea&&e instanceof Ea?to(t.gt,e.gt):t instanceof ma&&e instanceof ma}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class La extends Da{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class xa extends Da{constructor(t,e,n,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ma(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Pa(t,e,n){const i=new Map;Ys(t.length===n.length);for(let s=0;s<n.length;s++){const r=t[s],o=r.transform,a=e.data.field(r.field);i.set(r.field,pa(o,a,n[s]))}return i}function Fa(t,e,n){const i=new Map;for(const s of t){const t=s.transform,r=n.data.field(s.field);i.set(s.field,da(t,r,e))}return i}class Va extends Da{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ua extends Da{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ba{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Na(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=ka(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=ka(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=ia();return this.mutations.forEach((i=>{const s=t.get(i.key),r=s.overlayedDocument;let o=this.applyToLocalView(r,s.mutatedFields);o=e.has(i.key)?null:o;const a=_a(r,o);null!==a&&n.set(i.key,a),r.isValidDocument()||r.convertToNoDocument(gr.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),aa())}isEqual(t){return this.batchId===t.batchId&&dr(this.mutations,t.mutations,((t,e)=>Ra(t,e)))&&dr(this.baseMutations,t.baseMutations,((t,e)=>Ra(t,e)))}}class ja{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Ys(t.mutations.length===n.length);let i=ra;const s=t.mutations;for(let t=0;t<s.length;t++)i=i.insert(s[t].key,n[t].version);return new ja(t,e,n,i)}}class $a{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var qa,za;(za=qa||(qa={}))[za.OK=0]="OK",za[za.CANCELLED=1]="CANCELLED",za[za.UNKNOWN=2]="UNKNOWN",za[za.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",za[za.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",za[za.NOT_FOUND=5]="NOT_FOUND",za[za.ALREADY_EXISTS=6]="ALREADY_EXISTS",za[za.PERMISSION_DENIED=7]="PERMISSION_DENIED",za[za.UNAUTHENTICATED=16]="UNAUTHENTICATED",za[za.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",za[za.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",za[za.ABORTED=10]="ABORTED",za[za.OUT_OF_RANGE=11]="OUT_OF_RANGE",za[za.UNIMPLEMENTED=12]="UNIMPLEMENTED",za[za.INTERNAL=13]="INTERNAL",za[za.UNAVAILABLE=14]="UNAVAILABLE",za[za.DATA_LOSS=15]="DATA_LOSS",new Bs([4294967295,4294967295],0);class Ha{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Ka(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ga(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Qa(t,e){return Ka(t,e.toTimestamp())}function Wa(t){return Ys(!!t),gr.fromTimestamp(function(t){const e=zr(t);return new pr(e.seconds,e.nanos)}(t))}function Xa(t,e){return function(t){return new yr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Ya(t,e){return Xa(t.databaseId,e.path)}function Ja(t){const e=function(t){const e=yr.fromString(t);return Ys(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?yr.emptyPath():function(t){return Ys(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function Za(t,e,n){return{name:Ya(t,e),fields:n.value.mapValue.fields}}function tc(t){let e=Ja(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Ys(1===i);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=function(t){const e=ec(t);return e instanceof Io&&So(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new vo(nc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,kr(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new go(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new go(n,e)}(n.endAt)),function(t,e,n,i,s,r,o,a){return new Bo(t,e,n,i,s,r,o,a)}(e,s,o,r,a,"F",c,l)}function ec(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=nc(t.unaryFilter.field);return Eo.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=nc(t.unaryFilter.field);return Eo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=nc(t.unaryFilter.field);return Eo.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=nc(t.unaryFilter.field);return Eo.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Xs()}}(t):void 0!==t.fieldFilter?function(t){return Eo.create(nc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Xs()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Io.create(t.compositeFilter.filters.map((t=>ec(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Xs()}}(t.compositeFilter.op))}(t):Xs()}function nc(t){return wr.fromServerFormat(t.fieldPath)}function ic(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class sc{constructor(t){this.fe=t}}function rc(t){const e=tc({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?zo(e,e.limit,"L"):e}class oc{constructor(){}_e(t,e){this.me(t,e),e.ge()}me(t,e){if("nullValue"in t)this.ye(e,5);else if("booleanValue"in t)this.ye(e,10),e.pe(t.booleanValue?1:0);else if("integerValue"in t)this.ye(e,15),e.pe(Hr(t.integerValue));else if("doubleValue"in t){const n=Hr(t.doubleValue);isNaN(n)?this.ye(e,13):(this.ye(e,15),Or(n)?e.pe(0):e.pe(n))}else if("timestampValue"in t){const n=t.timestampValue;this.ye(e,20),"string"==typeof n?e.Ie(n):(e.Ie(`${n.seconds||""}`),e.pe(n.nanos||0))}else if("stringValue"in t)this.Te(t.stringValue,e),this.Ee(e);else if("bytesValue"in t)this.ye(e,30),e.Ae(Kr(t.bytesValue)),this.Ee(e);else if("referenceValue"in t)this.ve(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.ye(e,45),e.pe(n.latitude||0),e.pe(n.longitude||0)}else"mapValue"in t?uo(t)?this.ye(e,Number.MAX_SAFE_INTEGER):(this.Re(t.mapValue,e),this.Ee(e)):"arrayValue"in t?(this.Pe(t.arrayValue,e),this.Ee(e)):Xs()}Te(t,e){this.ye(e,25),this.be(t,e)}be(t,e){e.Ie(t)}Re(t,e){const n=t.fields||{};this.ye(e,55);for(const t of Object.keys(n))this.Te(t,e),this.me(n[t],e)}Pe(t,e){const n=t.values||[];this.ye(e,50);for(const t of n)this.me(t,e)}ve(t,e){this.ye(e,37),br.fromName(t).path.forEach((t=>{this.ye(e,60),this.be(t,e)}))}ye(t,e){t.pe(e)}Ee(t){t.pe(2)}}oc.Ve=new oc;class ac{constructor(){this.rn=new cc}addToCollectionParentIndex(t,e){return this.rn.add(e),Dr.resolve()}getCollectionParents(t,e){return Dr.resolve(this.rn.getEntries(e))}addFieldIndex(t,e){return Dr.resolve()}deleteFieldIndex(t,e){return Dr.resolve()}getDocumentsMatchingTarget(t,e){return Dr.resolve(null)}getIndexType(t,e){return Dr.resolve(0)}getFieldIndexes(t,e){return Dr.resolve([])}getNextCollectionGroupToUpdate(t){return Dr.resolve(null)}getMinOffset(t,e){return Dr.resolve(Ir.min())}getMinOffsetFromCollectionGroup(t,e){return Dr.resolve(Ir.min())}updateCollectionGroup(t,e,n){return Dr.resolve()}updateIndexEntries(t,e){return Dr.resolve()}}class cc{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Vr(yr.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Vr(yr.comparator)).toArray()}}new Uint8Array(0);class lc{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new lc(t,lc.DEFAULT_COLLECTION_PERCENTILE,lc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}lc.DEFAULT_COLLECTION_PERCENTILE=10,lc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lc.DEFAULT=new lc(41943040,lc.DEFAULT_COLLECTION_PERCENTILE,lc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lc.DISABLED=new lc(-1,0,0);class uc{constructor(t){this.Nn=t}next(){return this.Nn+=2,this.Nn}static kn(){return new uc(0)}static Mn(){return new uc(-1)}}class hc{constructor(){this.changes=new Xo((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,po.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Dr.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class fc{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class dc{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&ka(n.mutation,t,Br.empty(),pr.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,aa()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=aa()){const i=na();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=ta();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=na();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,aa())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let s=Jo();const r=sa(),o=sa();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof xa)?s=s.insert(e.key,e):void 0!==o?(r.set(e.key,o.mutation.getFieldMask()),ka(o.mutation,e,o.mutation.getFieldMask(),pr.now())):r.set(e.key,Br.empty())})),this.recalculateAndSaveOverlays(t,s).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new fc(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=sa();let i=new Mr(((t,e)=>t-e)),s=aa();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const s of t)s.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let o=n.get(t)||Br.empty();o=s.applyToLocalView(r,o),n.set(t,o);const a=(i.get(s.batchId)||aa()).add(t);i=i.insert(s.batchId,a)}))})).next((()=>{const r=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=ia();c.forEach((t=>{if(!s.has(t)){const i=_a(e.get(t),n.get(t));null!==i&&l.set(t,i),s=s.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Dr.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return br.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((s=>{const r=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-s.size):Dr.resolve(na());let o=-1,a=s;return r.next((e=>Dr.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(e)?Dr.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,s))).next((()=>this.computeViews(t,a,e,aa()))).next((t=>({batchId:o,changes:ea(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new br(e)).next((t=>{let e=ta();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let s=ta();return this.indexManager.getCollectionParents(t,i).next((r=>Dr.forEach(r,(r=>{const o=function(t,e){return new Bo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(i));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i)))).next((t=>{i.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,po.newInvalidDocument(i)))}));let n=ta();return t.forEach(((t,s)=>{const r=i.get(t);void 0!==r&&ka(r.mutation,s,Br.empty(),pr.now()),Qo(e,s)&&(n=n.insert(t,s))})),n}))}}class pc{constructor(t){this.serializer=t,this.cs=new Map,this.hs=new Map}getBundleMetadata(t,e){return Dr.resolve(this.cs.get(e))}saveBundleMetadata(t,e){var n;return this.cs.set(e.id,{id:(n=e).id,version:n.version,createTime:Wa(n.createTime)}),Dr.resolve()}getNamedQuery(t,e){return Dr.resolve(this.hs.get(e))}saveNamedQuery(t,e){return this.hs.set(e.name,function(t){return{name:t.name,query:rc(t.bundledQuery),readTime:Wa(t.readTime)}}(e)),Dr.resolve()}}class gc{constructor(){this.overlays=new Mr(br.comparator),this.ls=new Map}getOverlay(t,e){return Dr.resolve(this.overlays.get(e))}getOverlays(t,e){const n=na();return Dr.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.we(t,e,i)})),Dr.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.ls.delete(n)),Dr.resolve()}getOverlaysForCollection(t,e,n){const i=na(),s=e.length+1,r=new br(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Dr.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new Mr(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=na(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=na(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Dr.resolve(o)}we(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new $a(e,n));let s=this.ls.get(e);void 0===s&&(s=aa(),this.ls.set(e,s)),this.ls.set(e,s.add(n.key))}}class mc{constructor(){this.fs=new Vr(yc.ds),this.ws=new Vr(yc._s)}isEmpty(){return this.fs.isEmpty()}addReference(t,e){const n=new yc(t,e);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.ys(new yc(t,e))}ps(t,e){t.forEach((t=>this.removeReference(t,e)))}Is(t){const e=new br(new yr([])),n=new yc(e,t),i=new yc(e,t+1),s=[];return this.ws.forEachInRange([n,i],(t=>{this.ys(t),s.push(t.key)})),s}Ts(){this.fs.forEach((t=>this.ys(t)))}ys(t){this.fs=this.fs.delete(t),this.ws=this.ws.delete(t)}Es(t){const e=new br(new yr([])),n=new yc(e,t),i=new yc(e,t+1);let s=aa();return this.ws.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new yc(t,0),n=this.fs.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class yc{constructor(t,e){this.key=t,this.As=e}static ds(t,e){return br.comparator(t.key,e.key)||fr(t.As,e.As)}static _s(t,e){return fr(t.As,e.As)||br.comparator(t.key,e.key)}}class vc{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.vs=1,this.Rs=new Vr(yc.ds)}checkEmpty(t){return Dr.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const s=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new Ba(s,e,n,i);this.mutationQueue.push(r);for(const e of i)this.Rs=this.Rs.add(new yc(e.key,s)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Dr.resolve(r)}lookupMutationBatch(t,e){return Dr.resolve(this.Ps(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.bs(n),s=i<0?0:i;return Dr.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Dr.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(t){return Dr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new yc(e,0),i=new yc(e,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,i],(t=>{const e=this.Ps(t.As);s.push(e)})),Dr.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Vr(fr);return e.forEach((t=>{const e=new yc(t,0),i=new yc(t,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([e,i],(t=>{n=n.add(t.As)}))})),Dr.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;br.isDocumentKey(s)||(s=s.child(""));const r=new yc(new br(s),0);let o=new Vr(fr);return this.Rs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.As)),!0)}),r),Dr.resolve(this.Vs(o))}Vs(t){const e=[];return t.forEach((t=>{const n=this.Ps(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Ys(0===this.Ss(e.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return Dr.forEach(e.mutations,(i=>{const s=new yc(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Rs=n}))}Cn(t){}containsKey(t,e){const n=new yc(e,0),i=this.Rs.firstAfterOrEqual(n);return Dr.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Dr.resolve()}Ss(t,e){return this.bs(t)}bs(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Ps(t){const e=this.bs(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class wc{constructor(t){this.Ds=t,this.docs=new Mr(br.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,r=this.Ds(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Dr.resolve(n?n.document.mutableCopy():po.newInvalidDocument(e))}getEntries(t,e){let n=Jo();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():po.newInvalidDocument(t))})),Dr.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let s=Jo();const r=e.path,o=new br(r.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!r.isPrefixOf(t.path))break;t.path.length>r.length+1||Tr(Er(o),n)<=0||(i.has(o.key)||Qo(e,o))&&(s=s.insert(o.key,o.mutableCopy()))}return Dr.resolve(s)}getAllFromCollectionGroup(t,e,n,i){Xs()}Cs(t,e){return Dr.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new bc(this)}getSize(t){return Dr.resolve(this.size)}}class bc extends hc{constructor(t){super(),this.os=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.os.addEntry(t,i)):this.os.removeEntry(n)})),Dr.waitFor(e)}getFromCache(t,e){return this.os.getEntry(t,e)}getAllFromCache(t,e){return this.os.getEntries(t,e)}}class Ec{constructor(t){this.persistence=t,this.xs=new Xo((t=>Vo(t)),Uo),this.lastRemoteSnapshotVersion=gr.min(),this.highestTargetId=0,this.Ns=0,this.ks=new mc,this.targetCount=0,this.Ms=uc.kn()}forEachTarget(t,e){return this.xs.forEach(((t,n)=>e(n))),Dr.resolve()}getLastRemoteSnapshotVersion(t){return Dr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Dr.resolve(this.Ns)}allocateTargetId(t){return this.highestTargetId=this.Ms.next(),Dr.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ns&&(this.Ns=e),Dr.resolve()}Fn(t){this.xs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ms=new uc(e),this.highestTargetId=e),t.sequenceNumber>this.Ns&&(this.Ns=t.sequenceNumber)}addTargetData(t,e){return this.Fn(e),this.targetCount+=1,Dr.resolve()}updateTargetData(t,e){return this.Fn(e),Dr.resolve()}removeTargetData(t,e){return this.xs.delete(e.target),this.ks.Is(e.targetId),this.targetCount-=1,Dr.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.xs.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.xs.delete(r),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Dr.waitFor(s).next((()=>i))}getTargetCount(t){return Dr.resolve(this.targetCount)}getTargetData(t,e){const n=this.xs.get(e)||null;return Dr.resolve(n)}addMatchingKeys(t,e,n){return this.ks.gs(e,n),Dr.resolve()}removeMatchingKeys(t,e,n){this.ks.ps(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),Dr.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.ks.Is(e),Dr.resolve()}getMatchingKeysForTargetId(t,e){const n=this.ks.Es(e);return Dr.resolve(n)}containsKey(t,e){return Dr.resolve(this.ks.containsKey(e))}}class Ic{constructor(t,e){this.$s={},this.overlays={},this.Os=new Nr(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=t(this),this.Bs=new Ec(this),this.indexManager=new ac,this.remoteDocumentCache=function(t){return new wc(t)}((t=>this.referenceDelegate.Ls(t))),this.serializer=new sc(e),this.qs=new pc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new gc,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.$s[t.toKey()];return n||(n=new vc(e,this.referenceDelegate),this.$s[t.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(t,e,n){Ks("MemoryPersistence","Starting transaction:",t);const i=new Tc(this.Os.next());return this.referenceDelegate.Us(),n(i).next((t=>this.referenceDelegate.Ks(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Gs(t,e){return Dr.or(Object.values(this.$s).map((n=>()=>n.containsKey(t,e))))}}class Tc extends Ar{constructor(t){super(),this.currentSequenceNumber=t}}class Sc{constructor(t){this.persistence=t,this.Qs=new mc,this.js=null}static zs(t){return new Sc(t)}get Ws(){if(this.js)return this.js;throw Xs()}addReference(t,e,n){return this.Qs.addReference(n,e),this.Ws.delete(n.toString()),Dr.resolve()}removeReference(t,e,n){return this.Qs.removeReference(n,e),this.Ws.add(n.toString()),Dr.resolve()}markPotentiallyOrphaned(t,e){return this.Ws.add(e.toString()),Dr.resolve()}removeTarget(t,e){this.Qs.Is(e.targetId).forEach((t=>this.Ws.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ws.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Us(){this.js=new Set}Ks(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Dr.forEach(this.Ws,(n=>{const i=br.fromPath(n);return this.Hs(t,i).next((t=>{t||e.removeEntry(i,gr.min())}))})).next((()=>(this.js=null,e.apply(t))))}updateLimboDocument(t,e){return this.Hs(t,e).next((t=>{t?this.Ws.delete(e.toString()):this.Ws.add(e.toString())}))}Ls(t){return 0}Hs(t,e){return Dr.or([()=>Dr.resolve(this.Qs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gs(t,e)])}}class Ac{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Fi=n,this.Bi=i}static Li(t,e){let n=aa(),i=aa();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Ac(t,e.fromCache,n,i)}}class Cc{constructor(){this.qi=!1}initialize(t,e){this.Ui=t,this.indexManager=e,this.qi=!0}getDocumentsMatchingQuery(t,e,n,i){return this.Ki(t,e).next((s=>s||this.Gi(t,e,i,n))).next((n=>n||this.Qi(t,e)))}Ki(t,e){if(jo(e))return Dr.resolve(null);let n=qo(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=zo(e,null,"F"),n=qo(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const s=aa(...i);return this.Ui.getDocuments(t,s).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.ji(e,i);return this.zi(e,r,s,n.readTime)?this.Ki(t,zo(e,null,"F")):this.Wi(t,r,e,n)}))))})))))}Gi(t,e,n,i){return jo(e)||i.isEqual(gr.min())?this.Qi(t,e):this.Ui.getDocuments(t,n).next((s=>{const r=this.ji(e,s);return this.zi(e,r,n,i)?this.Qi(t,e):(Hs()<=C.DEBUG&&Ks("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Go(e)),this.Wi(t,r,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=gr.fromTimestamp(1e9===i?new pr(n+1,0):new pr(n,i));return new Ir(s,br.empty(),e)}(i,-1)))}))}ji(t,e){let n=new Vr(function(t){return(e,n)=>{let i=!1;for(const s of $o(t)){const t=Wo(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{Qo(t,i)&&(n=n.add(i))})),n}zi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(t,e){return Hs()<=C.DEBUG&&Ks("QueryEngine","Using full collection scan to execute query:",Go(e)),this.Ui.getDocumentsMatchingQuery(t,e,Ir.min())}Wi(t,e,n,i){return this.Ui.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Dc{constructor(t,e,n,i){this.persistence=t,this.Hi=e,this.serializer=i,this.Ji=new Mr(fr),this.Yi=new Xo((t=>Vo(t)),Uo),this.Xi=new Map,this.Zi=t.getRemoteDocumentCache(),this.Bs=t.getTargetCache(),this.qs=t.getBundleCache(),this.tr(n)}tr(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new dc(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ji)))}}async function _c(t,e){const n=Js(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((s=>(i=s,n.tr(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const s=[],r=[];let o=aa();for(const t of i){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({er:t,removedBatchIds:s,addedBatchIds:r})))}))}))}function Nc(t,e){const n=Js(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}class kc{constructor(){this.activeTargetIds=ca}lr(t){this.activeTargetIds=this.activeTargetIds.add(t)}dr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}hr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Oc{constructor(){this.Hr=new kc,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Hr.lr(t),this.Jr[t]||"not-current"}updateQueryState(t,e,n){this.Jr[t]=e}removeLocalQueryTarget(t){this.Hr.dr(t)}isLocalQueryTarget(t){return this.Hr.activeTargetIds.has(t)}clearQueryState(t){delete this.Jr[t]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(t){return this.Hr.activeTargetIds.has(t)}start(){return this.Hr=new kc,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Rc{Yr(t){}shutdown(){}}class Lc{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(t){this.so.push(t)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Ks("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.so)t(0)}no(){Ks("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.so)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let xc=null;function Mc(){return null===xc?xc=268435456+Math.round(2147483648*Math.random()):xc++,"0x"+xc.toString(16)}const Pc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Fc{constructor(t){this.ro=t.ro,this.oo=t.oo}uo(t){this.co=t}ao(t){this.ho=t}onMessage(t){this.lo=t}close(){this.oo()}send(t){this.ro(t)}fo(){this.co()}wo(t){this.ho(t)}_o(t){this.lo(t)}}const Vc="WebChannelConnection";class Uc extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.mo=e+"://"+t.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(t,e,n,i,s){const r=Mc(),o=this.To(t,e);Ks("RestConnection",`Sending RPC '${t}' ${r}:`,o,n);const a={};return this.Eo(a,i,s),this.Ao(t,o,a,n).then((e=>(Ks("RestConnection",`Received RPC '${t}' ${r}: `,e),e)),(e=>{throw Qs("RestConnection",`RPC '${t}' ${r} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,i,s,r){return this.Io(t,e,n,i,s)}Eo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+qs,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}To(t,e){const n=Pc[t];return`${this.mo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Ao(t,e,n,i){const s=Mc();return new Promise(((r,o)=>{const a=new Us;a.setWithCredentials(!0),a.listenOnce(xs.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Ls.NO_ERROR:const e=a.getResponseJson();Ks(Vc,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(e)),r(e);break;case Ls.TIMEOUT:Ks(Vc,`RPC '${t}' ${s} timed out`),o(new tr(Zs.DEADLINE_EXCEEDED,"Request time out"));break;case Ls.HTTP_ERROR:const n=a.getStatus();if(Ks(Vc,`RPC '${t}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Zs).indexOf(e)>=0?e:Zs.UNKNOWN}(e.status);o(new tr(t,e.message))}else o(new tr(Zs.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new tr(Zs.UNAVAILABLE,"Connection failed."));break;default:Xs()}}finally{Ks(Vc,`RPC '${t}' ${s} completed.`)}}));const c=JSON.stringify(i);Ks(Vc,`RPC '${t}' ${s} sending request:`,i),a.send(e,"POST",c,n,15)}))}Ro(t,e,n){const i=Mc(),s=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Os(),o=Rs(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.xmlHttpFactory=new Fs({})),this.Eo(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=s.join("");Ks(Vc,`Creating RPC '${t}' stream ${i}: ${l}`,a);const u=r.createWebChannel(l,a);let h=!1,f=!1;const d=new Fc({ro:e=>{f?Ks(Vc,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(h||(Ks(Vc,`Opening RPC '${t}' stream ${i} transport.`),u.open(),h=!0),Ks(Vc,`RPC '${t}' stream ${i} sending:`,e),u.send(e))},oo:()=>u.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,Vs.EventType.OPEN,(()=>{f||Ks(Vc,`RPC '${t}' stream ${i} transport opened.`)})),p(u,Vs.EventType.CLOSE,(()=>{f||(f=!0,Ks(Vc,`RPC '${t}' stream ${i} transport closed`),d.wo())})),p(u,Vs.EventType.ERROR,(e=>{f||(f=!0,Qs(Vc,`RPC '${t}' stream ${i} transport errored:`,e),d.wo(new tr(Zs.UNAVAILABLE,"The operation could not be completed")))})),p(u,Vs.EventType.MESSAGE,(e=>{var n;if(!f){const s=e.data[0];Ys(!!s);const r=s,o=r.error||(null===(n=r[0])||void 0===n?void 0:n.error);if(o){Ks(Vc,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=qa[t];if(void 0!==e)return function(t){if(void 0===t)return Gs("GRPC error has no .code"),Zs.UNKNOWN;switch(t){case qa.OK:return Zs.OK;case qa.CANCELLED:return Zs.CANCELLED;case qa.UNKNOWN:return Zs.UNKNOWN;case qa.DEADLINE_EXCEEDED:return Zs.DEADLINE_EXCEEDED;case qa.RESOURCE_EXHAUSTED:return Zs.RESOURCE_EXHAUSTED;case qa.INTERNAL:return Zs.INTERNAL;case qa.UNAVAILABLE:return Zs.UNAVAILABLE;case qa.UNAUTHENTICATED:return Zs.UNAUTHENTICATED;case qa.INVALID_ARGUMENT:return Zs.INVALID_ARGUMENT;case qa.NOT_FOUND:return Zs.NOT_FOUND;case qa.ALREADY_EXISTS:return Zs.ALREADY_EXISTS;case qa.PERMISSION_DENIED:return Zs.PERMISSION_DENIED;case qa.FAILED_PRECONDITION:return Zs.FAILED_PRECONDITION;case qa.ABORTED:return Zs.ABORTED;case qa.OUT_OF_RANGE:return Zs.OUT_OF_RANGE;case qa.UNIMPLEMENTED:return Zs.UNIMPLEMENTED;case qa.DATA_LOSS:return Zs.DATA_LOSS;default:return Xs()}}(e)}(e),s=o.message;void 0===n&&(n=Zs.INTERNAL,s="Unknown error status: "+e+" with message "+o.message),f=!0,d.wo(new tr(n,s)),u.close()}else Ks(Vc,`RPC '${t}' stream ${i} received:`,s),d._o(s)}})),p(o,Ms.STAT_EVENT,(e=>{e.stat===Ps.PROXY?Ks(Vc,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===Ps.NOPROXY&&Ks(Vc,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{d.fo()}),0),d}}function Bc(){return"undefined"!=typeof document?document:null}function jc(t){return new Ha(t,!0)}class $c{constructor(t,e,n=1e3,i=1.5,s=6e4){this.ii=t,this.timerId=e,this.Po=n,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(t){this.cancel();const e=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,e-n);i>0&&Ks("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,(()=>(this.Co=Date.now(),t()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class qc{constructor(t,e,n,i,s,r,o,a){this.ii=t,this.$o=n,this.Oo=i,this.connection=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new $c(t,e)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(t){this.Ho(),this.stream.send(t)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(t,e){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==t?this.qo.reset():e&&e.code===Zs.RESOURCE_EXHAUSTED?(Gs(e.toString()),Gs("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):e&&e.code===Zs.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.ao(e)}Yo(){}auth(){this.state=1;const t=this.Xo(this.Fo),e=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Fo===e&&this.Zo(t,n)}),(e=>{t((()=>{const t=new tr(Zs.UNKNOWN,"Fetching auth token failed: "+e.message);return this.tu(t)}))}))}Zo(t,e){const n=this.Xo(this.Fo);this.stream=this.eu(t,e),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((t=>{n((()=>this.tu(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(t){return Ks("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Xo(t){return e=>{this.ii.enqueueAndForget((()=>this.Fo===t?e():(Ks("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class zc extends qc{constructor(t,e,n,i,s,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,r),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(t,e){return this.connection.Ro("Write",t,e)}onMessage(t){if(Ys(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.qo.reset();const e=function(t,e){return t&&t.length>0?(Ys(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Wa(t.updateTime):Wa(e);return n.isEqual(gr.min())&&(n=Wa(e)),new Sa(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Wa(t.commitTime);return this.listener.cu(n,e)}return Ys(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.au()}hu(){const t={};t.database=function(t){return new yr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.serializer),this.Wo(t)}uu(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof La)n={update:Za(t,e.key,e.value)};else if(e instanceof Va)n={delete:Ya(t,e.key)};else if(e instanceof xa)n={update:Za(t,e.key,e.data),updateMask:ic(e.fieldMask)};else{if(!(e instanceof Ua))return Xs();n={verify:Ya(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof ma)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ya)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof wa)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ea)return{fieldPath:e.field.canonicalString(),increment:n.gt};throw Xs()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Qa(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Xs()}(t,e.precondition)),n}(this.serializer,t)))};this.Wo(e)}}class Hc extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new tr(Zs.FAILED_PRECONDITION,"The client has already been terminated.")}Io(t,e,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Io(t,e,n,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Zs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new tr(Zs.UNKNOWN,t.toString())}))}vo(t,e,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.connection.vo(t,e,n,s,r,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Zs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new tr(Zs.UNKNOWN,t.toString())}))}terminate(){this.lu=!0}}class Kc{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(t){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.yu("Offline")))}set(t){this.Tu(),this.wu=0,"Online"===t&&(this.mu=!1),this.yu(t)}yu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}pu(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Gs(e),this.mu=!1):Ks("OnlineStateTracker",e)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class Gc{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr((t=>{n.enqueueAndForget((async()=>{Xc(this)&&(Ks("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Js(t);e.vu.add(4),await Wc(e),e.bu.set("Unknown"),e.vu.delete(4),await Qc(e)}(this))}))})),this.bu=new Kc(n,i)}}async function Qc(t){if(Xc(t))for(const e of t.Ru)await e(!0)}async function Wc(t){for(const e of t.Ru)await e(!1)}function Xc(t){return 0===Js(t).vu.size}async function Yc(t,e,n){if(!_r(e))throw e;t.vu.add(1),await Wc(t),t.bu.set("Offline"),n||(n=()=>function(t){const e=Js(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Bs.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ks("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await Qc(t)}))}function Jc(t,e){return e().catch((n=>Yc(t,n,e)))}async function Zc(t){const e=Js(t),n=ll(e);let i=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;tl(e);)try{const t=await Nc(e.localStore,i);if(null===t){0===e.Eu.length&&n.jo();break}i=t.batchId,el(e,t)}catch(t){await Yc(e,t)}nl(e)&&il(e)}function tl(t){return Xc(t)&&t.Eu.length<10}function el(t,e){t.Eu.push(e);const n=ll(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function nl(t){return Xc(t)&&!ll(t).Uo()&&t.Eu.length>0}function il(t){ll(t).start()}async function sl(t){ll(t).hu()}async function rl(t){const e=ll(t);for(const n of t.Eu)e.uu(n.mutations)}async function ol(t,e,n){const i=t.Eu.shift(),s=ja.from(i,e,n);await Jc(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await Zc(t)}async function al(t,e){e&&ll(t).ou&&await async function(t,e){if(function(t){switch(t){default:return Xs();case Zs.CANCELLED:case Zs.UNKNOWN:case Zs.DEADLINE_EXCEEDED:case Zs.RESOURCE_EXHAUSTED:case Zs.INTERNAL:case Zs.UNAVAILABLE:case Zs.UNAUTHENTICATED:return!1;case Zs.INVALID_ARGUMENT:case Zs.NOT_FOUND:case Zs.ALREADY_EXISTS:case Zs.PERMISSION_DENIED:case Zs.FAILED_PRECONDITION:case Zs.ABORTED:case Zs.OUT_OF_RANGE:case Zs.UNIMPLEMENTED:case Zs.DATA_LOSS:return!0}}(n=e.code)&&n!==Zs.ABORTED){const n=t.Eu.shift();ll(t).Qo(),await Jc(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await Zc(t)}var n}(t,e),nl(t)&&il(t)}async function cl(t,e){const n=Js(t);n.asyncQueue.verifyOperationInProgress(),Ks("RemoteStore","RemoteStore received new credentials");const i=Xc(n);n.vu.add(3),await Wc(n),i&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await Qc(n)}function ll(t){return t.Du||(t.Du=function(t,e,n){const i=Js(t);return i.fu(),new zc(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{uo:sl.bind(null,t),ao:al.bind(null,t),au:rl.bind(null,t),cu:ol.bind(null,t)}),t.Ru.push((async e=>{e?(t.Du.Qo(),await Zc(t)):(await t.Du.stop(),t.Eu.length>0&&(Ks("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))}))),t.Du}class ul{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,s){const r=Date.now()+n,o=new ul(t,e,r,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new tr(Zs.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hl(t,e){if(Gs("AsyncQueue",`${e}: ${t}`),_r(t))return new tr(Zs.UNAVAILABLE,`${e}: ${t}`);throw t}class fl{constructor(){this.queries=new Xo((t=>Ko(t)),Ho),this.onlineState="Unknown",this.ku=new Set}}class dl{constructor(t,e,n,i,s,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.dc={},this.wc=new Xo((t=>Ko(t)),Ho),this._c=new Map,this.mc=new Set,this.gc=new Mr(br.comparator),this.yc=new Map,this.Ic=new mc,this.Tc={},this.Ec=new Map,this.Ac=uc.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function pl(t,e,n){const i=Js(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.wc.forEach(((n,i)=>{const s=i.view.Mu(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=Js(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.Mu(e)&&(i=!0)})),i&&function(t){t.ku.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.dc.nu(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function gl(t,e){const n=Js(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Js(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.Zi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,r=s.keys();let o=Dr.resolve();return r.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);Ys(null!==r),e.version.compareTo(r)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=aa();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);vl(n,i,null),yl(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await wl(n,t)}catch(t){await Cr(t)}}async function ml(t,e,n){const i=Js(t);try{const t=await function(t,e){const n=Js(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Ys(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);vl(i,e,n),yl(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await wl(i,t)}catch(n){await Cr(n)}}function yl(t,e){(t.Ec.get(e)||[]).forEach((t=>{t.resolve()})),t.Ec.delete(e)}function vl(t,e,n){const i=Js(t);let s=i.Tc[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.Tc[i.currentUser.toKey()]=s}}async function wl(t,e,n){const i=Js(t),s=[],r=[],o=[];i.wc.isEmpty()||(i.wc.forEach(((t,a)=>{o.push(i.Rc(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){s.push(t);const e=Ac.Li(a.targetId,t);r.push(e)}})))})),await Promise.all(o),i.dc.nu(s),await async function(t,e){const n=Js(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Dr.forEach(e,(e=>Dr.forEach(e.Fi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Dr.forEach(e.Bi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!_r(t))throw t;Ks("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ji.get(e),i=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(i);n.Ji=n.Ji.insert(e,s)}}}(i.localStore,r))}async function bl(t,e){const n=Js(t);if(!n.currentUser.isEqual(e)){Ks("SyncEngine","User change. New user:",e.toKey());const t=await _c(n.localStore,e);n.currentUser=e,function(t,e){t.Ec.forEach((t=>{t.forEach((t=>{t.reject(new tr(Zs.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ec.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await wl(n,t.er)}}function El(t){const e=Js(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ml.bind(null,e),e}class Il{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=jc(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new Dc(t,e,n,i)}(this.persistence,new Cc,t.initialUser,this.serializer)}createPersistence(t){return new Ic(Sc.zs,this.serializer)}createSharedClientState(t){return new Oc}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Tl{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>pl(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=bl.bind(null,this.syncEngine),await async function(t,e){const n=Js(t);e?(n.vu.delete(2),await Qc(n)):e||(n.vu.add(2),await Wc(n),n.bu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new fl}createDatastore(t){const e=jc(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Uc(i));var i;return function(t,e,n,i){return new Hc(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,s=t=>pl(this.syncEngine,t,0),r=Lc.D()?new Lc:new Rc,new Gc(e,n,i,s,r);var e,n,i,s,r}createSyncEngine(t,e){return function(t,e,n,i,s,r,o){const a=new dl(t,e,n,i,s,r);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Js(t);Ks("RemoteStore","RemoteStore shutting down."),e.vu.add(5),await Wc(e),e.Pu.shutdown(),e.bu.set("Unknown")}(this.remoteStore)}}class Sl{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=$s.UNAUTHENTICATED,this.clientId=hr.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ks("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ks("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new tr(Zs.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=hl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Al(t,e){t.asyncQueue.verifyOperationInProgress(),Ks("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await _c(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Cl(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ks("FirestoreClient","Using user provided OfflineComponentProvider");try{await Al(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===Zs.FAILED_PRECONDITION||t.code===Zs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;Qs("Error using user provided cache. Falling back to memory cache: "+n),await Al(t,new Il)}}else Ks("FirestoreClient","Using default OfflineComponentProvider"),await Al(t,new Il);return t._offlineComponents}(t);Ks("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>cl(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>cl(e.remoteStore,n))),t._onlineComponents=e}function Dl(t){return async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ks("FirestoreClient","Using user provided OnlineComponentProvider"),await Cl(t,t._uninitializedComponentsProvider._online)):(Ks("FirestoreClient","Using default OnlineComponentProvider"),await Cl(t,new Tl))),t._onlineComponents}(t).then((t=>t.syncEngine))}function _l(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Nl=new Map;function kl(t,e,n){if(!n)throw new tr(Zs.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ol(t){if(!br.isDocumentKey(t))throw new tr(Zs.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Rl(t){if(br.isDocumentKey(t))throw new tr(Zs.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ll(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Xs()}function xl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new tr(Zs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ll(t);throw new tr(Zs.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Ml{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new tr(Zs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new tr(Zs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new tr(Zs.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_l(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new tr(Zs.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new tr(Zs.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new tr(Zs.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(e=this.experimentalLongPollingOptions,n=t.experimentalLongPollingOptions,e.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams;var e,n}}class Pl{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ml({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new tr(Zs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new tr(Zs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ml(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new ir;switch(t.type){case"firstParty":return new ar(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new tr(Zs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Nl.get(t);e&&(Ks("ComponentProvider","Removing Datastore"),Nl.delete(t),e.terminate())}(this),Promise.resolve()}}class Fl{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ul(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Fl(this.firestore,t,this._key)}}class Vl{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Vl(this.firestore,t,this._query)}}class Ul extends Vl{constructor(t,e,n){super(t,e,function(t){return new Bo(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Fl(this.firestore,null,new br(t))}withConverter(t){return new Ul(this.firestore,t,this._path)}}class Bl{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new $c(this,"async_queue_retry"),this.Xc=()=>{const t=Bc();t&&Ks("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const t=Bc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Zc(),this.ta(t)}enterRestrictedMode(t){if(!this.jc){this.jc=!0,this.Jc=t||!1;const e=Bc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Xc)}}enqueue(t){if(this.Zc(),this.jc)return new Promise((()=>{}));const e=new er;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Qc.push(t),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(t){if(!_r(t))throw t;Ks("AsyncQueue","Operation failed with retryable error: "+t)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(t){const e=this.Gc.then((()=>(this.Hc=!0,t().catch((t=>{this.Wc=t,this.Hc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Gs("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Hc=!1,t))))));return this.Gc=e,e}enqueueAfterDelay(t,e,n){this.Zc(),this.Yc.indexOf(t)>-1&&(e=0);const i=ul.createAndSchedule(this,t,e,n,(t=>this.na(t)));return this.zc.push(i),i}Zc(){this.Wc&&Xs()}verifyOperationInProgress(){}async sa(){let t;do{t=this.Gc,await t}while(t!==this.Gc)}ia(t){for(const e of this.zc)if(e.timerId===t)return!0;return!1}ra(t){return this.sa().then((()=>{this.zc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.zc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.sa()}))}oa(t){this.Yc.push(t)}na(t){const e=this.zc.indexOf(t);this.zc.splice(e,1)}}class jl extends Pl{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Bl,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||$l(this),this._firestoreClient.terminate()}}function $l(t){var e,n,i;const s=t._freezeSettings(),r=function(t,e,n,i){return new Xr(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,_l(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new Sl(t._authCredentials,t._appCheckCredentials,t._queue,r),(null===(n=s.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=s.cache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}class ql{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ql($r.fromBase64String(t))}catch(t){throw new tr(Zs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new ql($r.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class zl{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new tr(Zs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Hl{constructor(t){this._methodName=t}}class Kl{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new tr(Zs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new tr(Zs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return fr(this._lat,t._lat)||fr(this._long,t._long)}}const Gl=/^__.*__$/;class Ql{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new xa(t,this.data,this.fieldMask,e,this.fieldTransforms):new La(t,this.data,e,this.fieldTransforms)}}function Wl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xs()}}class Xl{constructor(t,e,n,i,s,r){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(t){return new Xl(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.aa({path:n,la:!1});return i.fa(t),i}da(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.aa({path:n,la:!1});return i.ua(),i}wa(t){return this.aa({path:void 0,la:!0})}_a(t){return ou(t,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}ua(){if(this.path)for(let t=0;t<this.path.length;t++)this.fa(this.path.get(t))}fa(t){if(0===t.length)throw this._a("Document fields must not be empty");if(Wl(this.ca)&&Gl.test(t))throw this._a('Document fields cannot begin and end with "__"')}}class Yl{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||jc(t)}ya(t,e,n,i=!1){return new Xl({ca:t,methodName:e,ga:n,path:wr.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jl(t){const e=t._freezeSettings(),n=jc(t._databaseId);return new Yl(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Zl(t,e,n,i,s,r={}){const o=t.ya(r.merge||r.mergeFields?2:0,e,n,s);iu("Data must be an object, but it was:",o,i);const a=eu(i,o);let c,l;if(r.merge)c=new Br(o.fieldMask),l=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const i of r.mergeFields){const s=su(e,i,n);if(!o.contains(s))throw new tr(Zs.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);au(t,s)||t.push(s)}c=new Br(t),l=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=o.fieldTransforms;return new Ql(new ho(a),c,l)}function tu(t,e){if(nu(t=b(t)))return iu("Unsupported field value:",e,t),eu(t,e);if(t instanceof Hl)return function(t,e){if(!Wl(e.ca))throw e._a(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e._a(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=tu(s,e.wa(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=b(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ha(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=pr.fromDate(t);return{timestampValue:Ka(e.serializer,n)}}if(t instanceof pr){const n=new pr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ka(e.serializer,n)}}if(t instanceof Kl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ql)return{bytesValue:Ga(e.serializer,t._byteString)};if(t instanceof Fl){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Xa(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e._a(`Unsupported field value: ${Ll(t)}`)}(t,e)}function eu(t,e){const n={};return xr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Lr(t,((t,i)=>{const s=tu(i,e.ha(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function nu(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof pr||t instanceof Kl||t instanceof ql||t instanceof Fl||t instanceof Hl)}function iu(t,e,n){if(!nu(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Ll(n);throw"an object"===i?e._a(t+" a custom object"):e._a(t+" "+i)}}function su(t,e,n){if((e=b(e))instanceof zl)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(ru)>=0)throw ou(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new zl(...e.split("."))._internalPath}catch(i){throw ou(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw ou("Field path arguments must be of type string or ",t,!1,void 0,n)}const ru=new RegExp("[~\\*/\\[\\]]");function ou(t,e,n,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new tr(Zs.INVALID_ARGUMENT,a+t+c)}function au(t,e){return t.some((t=>t.isEqual(e)))}function cu(t,e){const n=xl(t.firestore,jl),i=function(t,e,...n){if(t=b(t),1===arguments.length&&(e=hr.A()),kl("doc","path",e),t instanceof Pl){const i=yr.fromString(e,...n);return Ol(i),new Fl(t,null,new br(i))}{if(!(t instanceof Fl||t instanceof Ul))throw new tr(Zs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(yr.fromString(e,...n));return Ol(i),new Fl(t.firestore,t instanceof Ul?t.converter:null,new br(i))}}(t),s=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return function(t,e){return function(t,e){const n=new er;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=El(t);try{const t=await function(t,e){const n=Js(t),i=pr.now(),s=e.reduce(((t,e)=>t.add(e.key)),aa());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Jo(),c=aa();return n.Zi.getEntries(t,s).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((s=>{r=s;const o=[];for(const t of e){const e=Oa(t,r.get(t.key).overlayedDocument);null!=e&&o.push(new xa(t.key,e,fo(e.value.mapValue),Aa.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:ea(r)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Tc[t.currentUser.toKey()];i||(i=new Mr(fr)),i=i.insert(e,n),t.Tc[t.currentUser.toKey()]=i}(i,t.batchId,n),await wl(i,t.changes),await Zc(i.remoteStore)}catch(t){const e=hl(t,"Failed to persist write");n.reject(e)}}(await Dl(t),e,n))),n.promise}(function(t){return t._firestoreClient||$l(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[Zl(Jl(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,Aa.exists(!1))]).then((()=>i))}!function(t,e=!0){qs="9.22.1",rt(new E("firestore",((t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),r=new jl(new rr(t.getProvider("auth-internal")),new lr(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new tr(Zs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yr(t.options.projectId,e)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),r._setSettings(i),r}),"PUBLIC").setMultipleInstances(!0)),ht(js,"3.12.1",t),ht(js,"3.12.1","esm2017")}();const lu=(t,e)=>e.some((e=>t instanceof e));let uu,hu;const fu=new WeakMap,du=new WeakMap,pu=new WeakMap,gu=new WeakMap,mu=new WeakMap;let yu={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return du.get(t);if("objectStoreNames"===e)return t.objectStoreNames||pu.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return wu(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function vu(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(hu||(hu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(bu(this),t),wu(fu.get(this))}:function(...t){return wu(e.apply(bu(this),t))}:function(t,...n){const i=e.call(bu(this),t,...n);return pu.set(i,t.sort?t.sort():[t]),wu(i)}:(t instanceof IDBTransaction&&function(t){if(du.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));du.set(t,e)}(t),lu(t,uu||(uu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,yu):t);var e}function wu(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(wu(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&fu.set(e,t)})).catch((()=>{})),mu.set(e,t),e}(t);if(gu.has(t))return gu.get(t);const e=vu(t);return e!==t&&(gu.set(t,e),mu.set(e,t)),e}const bu=t=>mu.get(t),Eu=["get","getKey","getAll","getAllKeys","count"],Iu=["put","add","delete","clear"],Tu=new Map;function Su(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Tu.get(e))return Tu.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=Iu.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!Eu.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return Tu.set(e,r),r}yu=(t=>({...t,get:(e,n,i)=>Su(e,n)||t.get(e,n,i),has:(e,n)=>!!Su(e,n)||t.has(e,n)}))(yu);const Au="@firebase/installations",Cu="0.6.4",Du=1e4,_u=`w:${Cu}`,Nu="FIS_v2",ku="https://firebaseinstallations.googleapis.com/v1",Ou=36e5,Ru=new h("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Lu(t){return t instanceof u&&t.code.includes("request-failed")}function xu({projectId:t}){return`${ku}/projects/${t}/installations`}function Mu(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function Pu(t,e){const n=(await e.json()).error;return Ru.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Fu({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function Vu(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Uu(t){return new Promise((e=>{setTimeout(e,t)}))}const Bu=/^[cdef][\w-]{21}$/,ju="";function $u(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return Bu.test(e)?e:ju}catch(t){return ju}}function qu(t){return`${t.appName}!${t.appId}`}const zu=new Map;function Hu(t,e){const n=qu(t);Ku(n,e),function(t,e){const n=(!Gu&&"BroadcastChannel"in self&&(Gu=new BroadcastChannel("[Firebase] FID Change"),Gu.onmessage=t=>{Ku(t.data.key,t.data.fid)}),Gu);n&&n.postMessage({key:t,fid:e}),0===zu.size&&Gu&&(Gu.close(),Gu=null)}(n,e)}function Ku(t,e){const n=zu.get(t);if(n)for(const t of n)t(e)}let Gu=null;const Qu="firebase-installations-database",Wu=1,Xu="firebase-installations-store";let Yu=null;function Ju(){return Yu||(Yu=function(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=wu(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(wu(o.result),t.oldVersion,t.newVersion,wu(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}(Qu,Wu,{upgrade:(t,e)=>{0===e&&t.createObjectStore(Xu)}})),Yu}async function Zu(t,e){const n=qu(t),i=(await Ju()).transaction(Xu,"readwrite"),s=i.objectStore(Xu),r=await s.get(n);return await s.put(e,n),await i.done,r&&r.fid===e.fid||Hu(t,e.fid),e}async function th(t){const e=qu(t),n=(await Ju()).transaction(Xu,"readwrite");await n.objectStore(Xu).delete(e),await n.done}async function eh(t,e){const n=qu(t),i=(await Ju()).transaction(Xu,"readwrite"),s=i.objectStore(Xu),r=await s.get(n),o=e(r);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,!o||r&&r.fid===o.fid||Hu(t,o.fid),o}async function nh(t){let e;const n=await eh(t.appConfig,(n=>{const i=function(t){return rh(t||{fid:$u(),registrationStatus:0})}(n),s=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Ru.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=xu(t),s=Fu(t),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={fid:n,authVersion:Nu,appId:t.appId,sdkVersion:_u},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await Vu((()=>fetch(i,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:Mu(t.authToken)}}throw await Pu("Create Installation",c)}(t,e);return Zu(t.appConfig,n)}catch(n){throw Lu(n)&&409===n.customData.serverCode?await th(t.appConfig):await Zu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:ih(t)}:{installationEntry:e}}(t,i);return e=s.registrationPromise,s.installationEntry}));return n.fid===ju?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function ih(t){let e=await sh(t.appConfig);for(;1===e.registrationStatus;)await Uu(100),e=await sh(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await nh(t);return n||e}return e}function sh(t){return eh(t,(t=>{if(!t)throw Ru.create("installation-not-found");return rh(t)}))}function rh(t){return 1===(e=t).registrationStatus&&e.registrationTime+Du<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function oh({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${xu(t)}/${e}/authTokens:generate`}(t,n),s=function(t,{refreshToken:e}){const n=Fu(t);return n.append("Authorization",function(t){return`${Nu} ${t}`}(e)),n}(t,n),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={installation:{sdkVersion:_u,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await Vu((()=>fetch(i,a)));if(c.ok)return Mu(await c.json());throw await Pu("Generate Auth Token",c)}async function ah(t,e=!1){let n;const i=await eh(t.appConfig,(i=>{if(!lh(i))throw Ru.create("not-registered");const s=i.authToken;if(!e&&(2===(r=s).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Ou}(r)))return i;var r;if(1===s.requestStatus)return n=async function(t,e){let n=await ch(t.appConfig);for(;1===n.authToken.requestStatus;)await Uu(100),n=await ch(t.appConfig);const i=n.authToken;return 0===i.requestStatus?ah(t,e):i}(t,e),i;{if(!navigator.onLine)throw Ru.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await oh(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await Zu(t.appConfig,i),n}catch(n){if(!Lu(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Zu(t.appConfig,n)}else await th(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function ch(t){return eh(t,(t=>{if(!lh(t))throw Ru.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+Du<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function lh(t){return void 0!==t&&2===t.registrationStatus}function uh(t){return Ru.create("missing-app-config-values",{valueName:t})}const hh="installations";rt(new E(hh,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw uh("App Configuration");if(!t.name)throw uh("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw uh(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:ot(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),rt(new E("installations-internal",(t=>{const e=ot(t.getProvider("app").getImmediate(),hh).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await nh(e);return i?i.catch(console.error):ah(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await nh(t);e&&await e}(n),(await ah(n,e)).token}(e,t)}}),"PRIVATE")),ht(Au,Cu),ht(Au,Cu,"esm2017");const fh="analytics",dh="firebase_id",ph="origin",gh=6e4,mh="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",yh="https://www.googletagmanager.com/gtag/js",vh=new R("@firebase/analytics"),wh=new h("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function bh(t){if(!t.startsWith(yh)){const e=wh.create("invalid-gtag-resource",{gtagURL:t});return vh.warn(e.message),""}return t}function Eh(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const Ih=30,Th=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Sh(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Ah(t,e=Th,n){const{appId:i,apiKey:s,measurementId:r}=t.options;if(!i)throw wh.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw wh.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Dh;return setTimeout((async()=>{a.abort()}),void 0!==n?n:gh),Ch({appId:i,apiKey:s,measurementId:r},o,a,e)}async function Ch(t,{throttleEndTimeMillis:e,backoffCount:n},i,s=Th){var r;const{appId:o,measurementId:a}=t;try{await function(t,e){return new Promise(((n,i)=>{const s=Math.max(e-Date.now(),0),r=setTimeout(n,s);t.addEventListener((()=>{clearTimeout(r),i(wh.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(a)return vh.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:o,measurementId:a};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,s={method:"GET",headers:Sh(i)},r=mh.replace("{app-id}",n),o=await fetch(r,s);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw wh.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return s.deleteThrottleMetadata(o),e}catch(e){const c=e;if(!function(t){if(!(t instanceof u&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c)){if(s.deleteThrottleMetadata(o),a)return vh.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw e}const l=503===Number(null===(r=null==c?void 0:c.customData)||void 0===r?void 0:r.httpStatus)?w(n,s.intervalMillis,Ih):w(n,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+l,backoffCount:n+1};return s.setThrottleMetadata(o,h),vh.debug(`Calling attemptFetch again in ${l} millis`),Ch(t,h,i,s)}}class Dh{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let _h,Nh;async function kh(t,e,n,i,s,r,o){var a;const u=Ah(t);u.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&vh.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>vh.error(t))),e.push(u);const h=async function(){if(!c())return vh.warn(wh.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await l()}catch(t){return vh.warn(wh.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[f,d]=await Promise.all([u,h]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(yh)&&n.src.includes(t))return n;return null})(r)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:bh}),i=document.createElement("script"),s=`${yh}?l=${t}&id=${e}`;i.src=n?null==n?void 0:n.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}(r,f.measurementId),Nh&&(s("consent","default",Nh),Nh=void 0),s("js",new Date);const p=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return p[ph]="firebase",p.update=!0,null!=d&&(p[dh]=d),s("config",f.measurementId,p),_h&&(s("set",_h),_h=void 0),f.measurementId}class Oh{constructor(t){this.app=t}_delete(){return delete Rh[this.app.options.appId],Promise.resolve()}}let Rh={},Lh=[];const xh={};let Mh,Ph,Fh="dataLayer",Vh=!1;function Uh(t,e,n){!function(){const t=[];if(function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=wh.create("invalid-analytics-context",{errorInfo:e});vh.warn(n.message)}}();const i=t.options.appId;if(!i)throw wh.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw wh.create("no-api-key");vh.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Rh[i])throw wh.create("already-exists",{id:i});if(!Vh){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Fh);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,s){let r=function(...t){window[i].push(arguments)};return window[s]&&"function"==typeof window[s]&&(r=window[s]),window[s]=function(t,e,n,i){return async function(s,...r){try{if("event"===s){const[i,s]=r;await async function(t,e,n,i,s){try{let r=[];if(s&&s.send_to){let t=s.send_to;Array.isArray(t)||(t=[t]);const i=await Eh(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),s=t&&e[t.appId];if(!s){r=[];break}r.push(s)}}0===r.length&&(r=Object.values(e)),await Promise.all(r),t("event",i,s||{})}catch(t){vh.error(t)}}(t,e,n,i,s)}else if("config"===s){const[s,o]=r;await async function(t,e,n,i,s,r){const o=i[s];try{if(o)await e[o];else{const t=(await Eh(n)).find((t=>t.measurementId===s));t&&await e[t.appId]}}catch(t){vh.error(t)}t("config",s,r)}(t,e,n,i,s,o)}else if("consent"===s){const[e]=r;t("consent","update",e)}else if("get"===s){const[e,n,i]=r;t("get",e,n,i)}else if("set"===s){const[e]=r;t("set",e)}else t(s,...r)}catch(t){vh.error(t)}}}(r,t,e,n),{gtagCore:r,wrappedGtag:window[s]}}(Rh,Lh,xh,Fh,"gtag");Ph=t,Mh=e,Vh=!0}return Rh[i]=kh(t,Lh,xh,e,Mh,Fh,n),new Oh(t)}function Bh(t,e,n,i){t=b(t),async function(t,e,n,i,s){if(s&&s.global)t("event",n,i);else{const s=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:s}))}}(Ph,Rh[t.app.options.appId],e,n,i).catch((t=>vh.error(t)))}const jh="@firebase/analytics",$h="0.10.0";rt(new E(fh,((t,{options:e})=>Uh(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),rt(new E("analytics-internal",(function(t){try{const e=t.getProvider(fh).getImmediate();return{logEvent:(t,n,i)=>Bh(e,t,n,i)}}catch(t){throw wh.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),ht(jh,$h),ht(jh,$h,"esm2017");const qh=lt({apiKey:"AIzaSyAHi3PBfzDXXjLG2bu2XPT6-lD2GQ23_2g",authDomain:"notify-me-form.firebaseapp.com",projectId:"notify-me-form",storageBucket:"notify-me-form.appspot.com",messagingSenderId:"511688313802",appId:"1:511688313802:web:204150e95182f04ded5d33",measurementId:"G-60YWSN4BV9"}),zh=function(t,e){const n=ot(ut(),"firestore").getImmediate({identifier:"(default)"});if(!n._initialized){const t=(t=>{const e=(t=>{var e,n;return null===(n=null===(e=r())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})("firestore");t&&function(t,e,n,i={}){var r;const o=(t=xl(t,Pl))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Qs("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:`${e}:${n}`,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=$s.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new tr(Zs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new $s(o)}t._authCredentials=new sr(new nr(e,n))}}(n,...t)}return n}(),Hh=function(t=ut()){const e=ot(t=b(t),fh);return e.isInitialized()?e.getImmediate():function(t,e={}){const n=ot(t,fh);if(n.isInitialized()){const t=n.getImmediate();if(d(e,n.getOptions()))return t;throw wh.create("already-initialized")}return n.initialize({options:e})}(t)}(qh);window.storeData=async function(t,e){try{if("string"!=typeof t||"boolean"!=typeof e)throw"Wrong arguement types";var n=Date.now();return await cu(function(t,e,...n){if(t=b(t),kl("collection","path",e),t instanceof Pl){const i=yr.fromString(e,...n);return Rl(i),new Ul(t,null,i)}{if(!(t instanceof Fl||t instanceof Ul))throw new tr(Zs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(yr.fromString(e,...n));return Rl(i),new Ul(t.firestore,null,i)}}(zh,"users"),{emailAdress:t,preRelease:e,time:n}),Bh(Hh,"form_submit",{pre_release:e}),"Success"}catch(t){return"Error"}}})();